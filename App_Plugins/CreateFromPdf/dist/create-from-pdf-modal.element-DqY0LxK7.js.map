{"version":3,"file":"create-from-pdf-modal.element-DqY0LxK7.js","sources":["../src/create-from-pdf-modal.element.ts"],"sourcesContent":["import type { UmbCreateFromPdfModalData, UmbCreateFromPdfModalValue, SourceType } from './create-from-pdf-modal.token.js';\r\nimport { html, customElement, css, state, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport type { UUIInputEvent } from '@umbraco-cms/backoffice/external/uui';\r\nimport type { UmbInputMediaElement } from '@umbraco-cms/backoffice/media';\r\nimport { UMB_AUTH_CONTEXT } from '@umbraco-cms/backoffice/auth';\r\n\r\n@customElement('create-from-pdf-modal')\r\nexport class CreateFromPdfModalElement extends UmbModalBaseElement<\r\n\tUmbCreateFromPdfModalData,\r\n\tUmbCreateFromPdfModalValue\r\n> {\r\n\t@state()\r\n\tprivate _documentName = '';\r\n\r\n\t@state()\r\n\tprivate _sourceType: SourceType | '' = '';\r\n\r\n\t@state()\r\n\tprivate _sourceUrl = '';\r\n\r\n\t@state()\r\n\tprivate _selectedMediaUnique: string | null = null;\r\n\r\n\t@state()\r\n\tprivate _pageTitle = '';\r\n\r\n\t@state()\r\n\tprivate _pageTitleShort = '';\r\n\r\n\t@state()\r\n\tprivate _pageDescription = '';\r\n\r\n\t@state()\r\n\tprivate _itineraryContent = '';\r\n\r\n\t@state()\r\n\tprivate _isExtracting = false;\r\n\r\n\t@state()\r\n\tprivate _extractionError: string | null = null;\r\n\r\n\toverride firstUpdated() {\r\n\t\tthis._documentName = '';\r\n\t\tthis._sourceType = '';\r\n\t\tthis._sourceUrl = '';\r\n\t\tthis._selectedMediaUnique = null;\r\n\t\tthis._pageTitle = '';\r\n\t\tthis._pageTitleShort = '';\r\n\t\tthis._pageDescription = '';\r\n\t\tthis._itineraryContent = '';\r\n\t}\r\n\r\n\t#handleSourceTypeChange(e: Event) {\r\n\t\tconst target = e.target as Element & { value: string };\r\n\t\tconst newSourceType = target.value as SourceType | '';\r\n\t\tconsole.log('Source type change event:', e.type, 'value:', newSourceType, 'target:', target.tagName);\r\n\r\n\t\t// Reset source-specific state when changing source type\r\n\t\tif (newSourceType !== this._sourceType) {\r\n\t\t\tthis._selectedMediaUnique = null;\r\n\t\t\tthis._sourceUrl = '';\r\n\t\t\tthis._pageTitle = '';\r\n\t\t\tthis._pageTitleShort = '';\r\n\t\t\tthis._pageDescription = '';\r\n\t\t\tthis._itineraryContent = '';\r\n\t\t\tthis._extractionError = null;\r\n\t\t}\r\n\r\n\t\tthis._sourceType = newSourceType;\r\n\t\tconsole.log('Source type set to:', this._sourceType);\r\n\t\tthis.requestUpdate();\r\n\t}\r\n\r\n\tasync #handleMediaChange(e: CustomEvent) {\r\n\t\tconsole.log('Media change event fired', e);\r\n\t\tconst target = e.target as UmbInputMediaElement;\r\n\t\tconst selection = target.selection;\r\n\t\tconsole.log('Selection:', selection);\r\n\t\tthis._selectedMediaUnique = selection.length > 0 ? selection[0] : null;\r\n\t\tconsole.log('Selected media unique:', this._selectedMediaUnique);\r\n\r\n\t\tif (this._selectedMediaUnique) {\r\n\t\t\tawait this.#extractPdfProperties(this._selectedMediaUnique);\r\n\t\t} else {\r\n\t\t\t// Clear extracted values if no media selected\r\n\t\t\tthis._pageTitle = '';\r\n\t\t\tthis._pageTitleShort = '';\r\n\t\t\tthis._pageDescription = '';\r\n\t\t\tthis._itineraryContent = '';\r\n\t\t\tthis._documentName = '';\r\n\t\t\tthis._extractionError = null;\r\n\t\t}\r\n\t}\r\n\r\n\tasync #extractPdfProperties(mediaUnique: string) {\r\n\t\tconsole.log('Starting PDF extraction for:', mediaUnique);\r\n\t\tthis._isExtracting = true;\r\n\t\tthis._extractionError = null;\r\n\r\n\t\ttry {\r\n\t\t\tconsole.log('Getting auth context...');\r\n\t\t\tconst authContext = await this.getContext(UMB_AUTH_CONTEXT);\r\n\t\t\tconst token = await authContext.getLatestToken();\r\n\t\t\tconsole.log('Got token, calling API...');\r\n\r\n\t\t\tconst response = await fetch(\r\n\t\t\t\t`/umbraco/management/api/v1/createfrompdf/page-properties?mediaKey=${mediaUnique}`,\r\n\t\t\t\t{\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log('API response status:', response.status);\r\n\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\tconst error = await response.json();\r\n\t\t\t\tconsole.error('API error:', error);\r\n\t\t\t\tthis._extractionError = error.error || 'Failed to extract PDF properties';\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst result = await response.json();\r\n\t\t\tconsole.log('Extraction result:', result);\r\n\r\n\t\t\t// Set extracted values\r\n\t\t\tthis._pageTitle = result.title || '';\r\n\t\t\tthis._pageTitleShort = result.title || '';\r\n\t\t\tthis._pageDescription = result.description || '';\r\n\r\n\t\t\tconsole.log('Set values - title:', this._pageTitle, 'description:', this._pageDescription);\r\n\r\n\t\t\t// Pre-fill document name with extracted title\r\n\t\t\tif (result.title && !this._documentName) {\r\n\t\t\t\tthis._documentName = result.title;\r\n\t\t\t\tconsole.log('Pre-filled document name:', this._documentName);\r\n\t\t\t}\r\n\r\n\t\t\t// Extract Suggested Itinerary section\r\n\t\t\tawait this.#extractItinerarySection(mediaUnique, token);\r\n\t\t} catch (error) {\r\n\t\t\tthis._extractionError = 'Failed to connect to PDF extraction service';\r\n\t\t\tconsole.error('PDF extraction error:', error);\r\n\t\t} finally {\r\n\t\t\tthis._isExtracting = false;\r\n\t\t\tconsole.log('Extraction complete, isExtracting:', this._isExtracting);\r\n\t\t\t// Force re-render to ensure UI updates\r\n\t\t\tthis.requestUpdate();\r\n\t\t}\r\n\t}\r\n\r\n\tasync #extractItinerarySection(mediaUnique: string, token: string) {\r\n\t\ttry {\r\n\t\t\tconsole.log('Extracting PDF as Markdown...');\r\n\t\t\tconst response = await fetch(\r\n\t\t\t\t`/umbraco/management/api/v1/createfrompdf/extract-markdown?mediaKey=${mediaUnique}`,\r\n\t\t\t\t{\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\t\tAuthorization: `Bearer ${token}`,\r\n\t\t\t\t\t},\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tif (response.ok) {\r\n\t\t\t\tconst result = await response.json();\r\n\t\t\t\tconsole.log('Markdown extraction result:', result);\r\n\t\t\t\tconsole.log('Title:', result.title);\r\n\t\t\t\tconsole.log('Subtitle:', result.subtitle);\r\n\t\t\t\tconsole.log('Markdown preview:', result.markdown?.substring(0, 500));\r\n\r\n\t\t\t\t// Store the Markdown content (will be converted to HTML in the action)\r\n\t\t\t\tthis._itineraryContent = result.markdown || '';\r\n\t\t\t} else {\r\n\t\t\t\tconst error = await response.json();\r\n\t\t\t\tconsole.log('Markdown extraction failed:', error);\r\n\t\t\t\tthis._itineraryContent = '';\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Failed to extract Markdown:', error);\r\n\t\t\tthis._itineraryContent = '';\r\n\t\t}\r\n\t}\r\n\r\n\t#handleSave() {\r\n\t\tthis.value = {\r\n\t\t\tname: this._documentName,\r\n\t\t\tsourceType: this._sourceType as SourceType,\r\n\t\t\tmediaUnique: this._selectedMediaUnique,\r\n\t\t\tsourceUrl: this._sourceUrl || null,\r\n\t\t\tpageTitle: this._pageTitle,\r\n\t\t\tpageTitleShort: this._pageTitleShort,\r\n\t\t\tpageDescription: this._pageDescription,\r\n\t\t\titineraryContent: this._itineraryContent,\r\n\t\t};\r\n\t\tthis.modalContext?.submit();\r\n\t}\r\n\r\n\t#handleClose() {\r\n\t\tthis.modalContext?.reject();\r\n\t}\r\n\r\n\t#renderSourceUI() {\r\n\t\tswitch (this._sourceType) {\r\n\t\t\tcase 'pdf':\r\n\t\t\t\treturn this.#renderPdfSource();\r\n\t\t\tcase 'web':\r\n\t\t\t\treturn this.#renderWebSource();\r\n\t\t\tcase 'doc':\r\n\t\t\t\treturn this.#renderDocSource();\r\n\t\t\tdefault:\r\n\t\t\t\treturn nothing;\r\n\t\t}\r\n\t}\r\n\r\n\t#renderPdfSource() {\r\n\t\treturn html`\r\n\t\t\t<umb-property-layout label=\"PDF File\" orientation=\"vertical\">\r\n\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t<umb-input-media\r\n\t\t\t\t\t\tmax=\"1\"\r\n\t\t\t\t\t\t@change=${this.#handleMediaChange}>\r\n\t\t\t\t\t</umb-input-media>\r\n\t\t\t\t\t${this.#renderExtractionStatus()}\r\n\t\t\t\t</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderWebSource() {\r\n\t\treturn html`\r\n\t\t\t<umb-property-layout label=\"Web Page URL\" orientation=\"vertical\">\r\n\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t<uui-input\r\n\t\t\t\t\t\tlabel=\"URL\"\r\n\t\t\t\t\t\tplaceholder=\"https://example.com/page\"\r\n\t\t\t\t\t\t.value=${this._sourceUrl}\r\n\t\t\t\t\t\t@input=${(e: UUIInputEvent) => (this._sourceUrl = e.target.value as string)}>\r\n\t\t\t\t\t</uui-input>\r\n\t\t\t\t\t<div class=\"source-coming-soon\">\r\n\t\t\t\t\t\t<uui-icon name=\"icon-info\"></uui-icon>\r\n\t\t\t\t\t\t<span>Web page extraction is not yet available.</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderDocSource() {\r\n\t\treturn html`\r\n\t\t\t<umb-property-layout label=\"Word Document\" orientation=\"vertical\">\r\n\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t<umb-input-media\r\n\t\t\t\t\t\tmax=\"1\"\r\n\t\t\t\t\t\t@change=${(e: CustomEvent) => {\r\n\t\t\t\t\t\t\tconst target = e.target as UmbInputMediaElement;\r\n\t\t\t\t\t\t\tconst selection = target.selection;\r\n\t\t\t\t\t\t\tthis._selectedMediaUnique = selection.length > 0 ? selection[0] : null;\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t</umb-input-media>\r\n\t\t\t\t\t<div class=\"source-coming-soon\">\r\n\t\t\t\t\t\t<uui-icon name=\"icon-info\"></uui-icon>\r\n\t\t\t\t\t\t<span>Word document extraction is not yet available.</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderExtractionStatus() {\r\n\t\tif (this._isExtracting) {\r\n\t\t\treturn html`<div class=\"extraction-status extracting\">\r\n\t\t\t\t<uui-loader-bar></uui-loader-bar>\r\n\t\t\t\t<span>Extracting PDF properties...</span>\r\n\t\t\t</div>`;\r\n\t\t}\r\n\r\n\t\tif (this._extractionError) {\r\n\t\t\treturn html`<div class=\"extraction-status error\">\r\n\t\t\t\t<uui-icon name=\"icon-alert\"></uui-icon>\r\n\t\t\t\t<span>${this._extractionError}</span>\r\n\t\t\t</div>`;\r\n\t\t}\r\n\r\n\t\tif (this._pageTitle) {\r\n\t\t\treturn html`<div class=\"extraction-status success\">\r\n\t\t\t\t<uui-icon name=\"icon-check\"></uui-icon>\r\n\t\t\t\t<span>PDF properties extracted successfully</span>\r\n\t\t\t</div>`;\r\n\t\t}\r\n\r\n\t\treturn nothing;\r\n\t}\r\n\r\n\t#renderExtractedPreview() {\r\n\t\tif (!this._pageTitle && !this._pageDescription && !this._itineraryContent) {\r\n\t\t\treturn nothing;\r\n\t\t}\r\n\r\n\t\treturn html`\r\n\t\t\t<uui-box headline=\"Extracted Properties\" class=\"preview-box\">\r\n\t\t\t\t<div class=\"preview-item\">\r\n\t\t\t\t\t<strong>Page Title:</strong> ${this._pageTitle || '(empty)'}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"preview-item\">\r\n\t\t\t\t\t<strong>Page Description:</strong> ${this._pageDescription || '(empty)'}\r\n\t\t\t\t</div>\r\n\t\t\t\t${this._itineraryContent\r\n\t\t\t\t\t? html`<div class=\"preview-item itinerary-preview\">\r\n\t\t\t\t\t\t\t<strong>Suggested Itinerary:</strong>\r\n\t\t\t\t\t\t\t<div class=\"itinerary-content\">${this._itineraryContent.substring(0, 200)}${this._itineraryContent.length > 200 ? '...' : ''}</div>\r\n\t\t\t\t\t\t</div>`\r\n\t\t\t\t\t: nothing}\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\t#getCanCreate(): boolean {\r\n\t\tif (!this._documentName || this._isExtracting) return false;\r\n\r\n\t\tswitch (this._sourceType) {\r\n\t\t\tcase 'pdf':\r\n\t\t\t\treturn !!this._selectedMediaUnique;\r\n\t\t\tcase 'web':\r\n\t\t\tcase 'doc':\r\n\t\t\t\t// Not yet functional\r\n\t\t\t\treturn false;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tconst canCreate = this.#getCanCreate();\r\n\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=\"Create from Source\">\r\n\t\t\t\t<uui-box headline=\"Document Name\">\r\n\t\t\t\t\t<p>Enter a document name or let it be populated from the source. You can edit this later.</p>\r\n\t\t\t\t\t<uui-input\r\n\t\t\t\t\t\tid=\"name\"\r\n\t\t\t\t\t\tlabel=\"name\"\r\n\t\t\t\t\t\tplaceholder=\"Enter document name\"\r\n\t\t\t\t\t\t.value=${this._documentName}\r\n\t\t\t\t\t\t@input=${(e: UUIInputEvent) => (this._documentName = e.target.value as string)}>\r\n\t\t\t\t\t</uui-input>\r\n\t\t\t\t</uui-box>\r\n\r\n\t\t\t\t<uui-box headline=\"Source\">\r\n\t\t\t\t\t<umb-property-layout label=\"Source Type\" orientation=\"vertical\">\r\n\t\t\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t\t\t<uui-select\r\n\t\t\t\t\t\t\t\tlabel=\"Select source type\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Choose a source...\"\r\n\t\t\t\t\t\t\t\t.value=${this._sourceType}\r\n\t\t\t\t\t\t\t\t.options=${[\r\n\t\t\t\t\t\t\t\t\t{ name: 'PDF Document', value: 'pdf' },\r\n\t\t\t\t\t\t\t\t\t{ name: 'Web Page', value: 'web' },\r\n\t\t\t\t\t\t\t\t\t{ name: 'Word Document', value: 'doc' },\r\n\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t\t@change=${this.#handleSourceTypeChange}>\r\n\t\t\t\t\t\t\t</uui-select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</umb-property-layout>\r\n\r\n\t\t\t\t\t${this.#renderSourceUI()}\r\n\t\t\t\t</uui-box>\r\n\r\n\t\t\t\t${this.#renderExtractedPreview()}\r\n\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tslot=\"actions\"\r\n\t\t\t\t\tid=\"close\"\r\n\t\t\t\t\tlabel=\"Close\"\r\n\t\t\t\t\t@click=\"${this.#handleClose}\">\r\n\t\t\t\t\tClose\r\n\t\t\t\t</uui-button>\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tslot=\"actions\"\r\n\t\t\t\t\tid=\"save\"\r\n\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\tlabel=\"Create\"\r\n\t\t\t\t\t?disabled=${!canCreate}\r\n\t\t\t\t\t@click=\"${this.#handleSave}\">\r\n\t\t\t\t\tCreate\r\n\t\t\t\t</uui-button>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\tuui-input {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\r\n\t\t\tuui-box {\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\tp {\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t.extraction-status {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tmargin-top: var(--uui-size-space-3);\r\n\t\t\t\tpadding: var(--uui-size-space-2);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t}\r\n\r\n\t\t\t.extraction-status.extracting {\r\n\t\t\t\tbackground-color: var(--uui-color-surface-alt);\r\n\t\t\t}\r\n\r\n\t\t\t.extraction-status.error {\r\n\t\t\t\tbackground-color: var(--uui-color-danger-emphasis);\r\n\t\t\t\tcolor: var(--uui-color-danger-contrast);\r\n\t\t\t}\r\n\r\n\t\t\t.extraction-status.success {\r\n\t\t\t\tbackground-color: var(--uui-color-positive-emphasis);\r\n\t\t\t\tcolor: var(--uui-color-positive-contrast);\r\n\t\t\t}\r\n\r\n\t\t\t.preview-box {\r\n\t\t\t\tmargin-top: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t.preview-item {\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t.preview-item:last-child {\r\n\t\t\t\tmargin-bottom: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.itinerary-content {\r\n\t\t\t\tmargin-top: var(--uui-size-space-2);\r\n\t\t\t\tpadding: var(--uui-size-space-2);\r\n\t\t\t\tbackground-color: var(--uui-color-surface-alt);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\twhite-space: pre-wrap;\r\n\t\t\t\tmax-height: 100px;\r\n\t\t\t\toverflow-y: auto;\r\n\t\t\t}\r\n\r\n\t\t\tuui-select {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t.source-coming-soon {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tmargin-top: var(--uui-size-space-3);\r\n\t\t\t\tpadding: var(--uui-size-space-2);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tbackground-color: var(--uui-color-surface-alt);\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default CreateFromPdfModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'create-from-pdf-modal': CreateFromPdfModalElement;\r\n\t}\r\n}\r\n"],"names":["_CreateFromPdfModalElement_decorators","customElement","_CreateFromPdfModalElement","_a","UmbModalBaseElement","__privateAdd","_CreateFromPdfModalElement_instances","canCreate","__privateMethod","getCanCreate_fn","html","e","handleSourceTypeChange_fn","renderSourceUI_fn","renderExtractedPreview_fn","handleClose_fn","handleSave_fn","_init","__decoratorStart","target","newSourceType","handleMediaChange_fn","selection","extractPdfProperties_fn","mediaUnique","token","UMB_AUTH_CONTEXT","response","error","result","extractItinerarySection_fn","renderPdfSource_fn","renderWebSource_fn","renderDocSource_fn","nothing","renderExtractionStatus_fn","__decorateElement","UmbTextStyles","css","__runInitializers","CreateFromPdfModalElement"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQAA,IAAA,CAACC,GAAc,uBAAuB;AAC/B,IAAMC,IAAN,MAAMA,WAAkCC,KAAAC,IAG7C;AAAA,EAHK,cAAA;AAAA,UAAA,GAAA,SAAA;AAAA,IAAAC,EAAA,MAAAC;AAKN,SAAQ,gBAAgB,IAGxB,KAAQ,cAA+B,IAGvC,KAAQ,aAAa,IAGrB,KAAQ,uBAAsC,MAG9C,KAAQ,aAAa,IAGrB,KAAQ,kBAAkB,IAG1B,KAAQ,mBAAmB,IAG3B,KAAQ,oBAAoB,IAG5B,KAAQ,gBAAgB,IAGxB,KAAQ,mBAAkC;AAAA,EAAA;AAAA,EAEjC,eAAe;AACvB,SAAK,gBAAgB,IACrB,KAAK,cAAc,IACnB,KAAK,aAAa,IAClB,KAAK,uBAAuB,MAC5B,KAAK,aAAa,IAClB,KAAK,kBAAkB,IACvB,KAAK,mBAAmB,IACxB,KAAK,oBAAoB;AAAA,EAC1B;AAAA,EA8RS,SAAS;AACjB,UAAMC,IAAYC,EAAA,MAAKF,GAAAG,IAAL;AAElB,WAAOC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAQM,KAAK,aAAa;AAAA,eAClB,CAACC,MAAsB,KAAK,gBAAgBA,EAAE,OAAO,KAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAUnE,KAAK,WAAW;AAAA,mBACd;AAAA,MACV,EAAE,MAAM,gBAAgB,OAAO,MAAA;AAAA,MAC/B,EAAE,MAAM,YAAY,OAAO,MAAA;AAAA,MAC3B,EAAE,MAAM,iBAAiB,OAAO,MAAA;AAAA,IAAM,CACtC;AAAA,kBACSH,EAAA,MAAKF,GAAAM,EAAuB;AAAA;AAAA;AAAA;AAAA;AAAA,OAKvCJ,EAAA,MAAKF,GAAAO,GAAL,UAAsB;AAAA;AAAA;AAAA,MAGvBL,EAAA,MAAKF,GAAAQ,GAAL,UAA8B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAMrBN,EAAA,MAAKF,GAAAS,EAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBASf,CAACR,CAAS;AAAA,eACZC,EAAA,MAAKF,GAAAU,EAAW;AAAA;AAAA;AAAA;AAAA;AAAA,EAK9B;AAiFD;AAndOC,IAAAC,EAAAf,KAAAG,IAAA,eA6CNM,aAAwB,GAAU;AACjC,QAAMO,IAAS,EAAE,QACXC,IAAgBD,EAAO;AAC7B,UAAQ,IAAI,6BAA6B,EAAE,MAAM,UAAUC,GAAe,WAAWD,EAAO,OAAO,GAG/FC,MAAkB,KAAK,gBAC1B,KAAK,uBAAuB,MAC5B,KAAK,aAAa,IAClB,KAAK,aAAa,IAClB,KAAK,kBAAkB,IACvB,KAAK,mBAAmB,IACxB,KAAK,oBAAoB,IACzB,KAAK,mBAAmB,OAGzB,KAAK,cAAcA,GACnB,QAAQ,IAAI,uBAAuB,KAAK,WAAW,GACnD,KAAK,cAAA;AACN,GAEMC,mBAAmB,GAAgB;AACxC,UAAQ,IAAI,4BAA4B,CAAC;AAEzC,QAAMC,IADS,EAAE,OACQ;AACzB,UAAQ,IAAI,cAAcA,CAAS,GACnC,KAAK,uBAAuBA,EAAU,SAAS,IAAIA,EAAU,CAAC,IAAI,MAClE,QAAQ,IAAI,0BAA0B,KAAK,oBAAoB,GAE3D,KAAK,uBACR,MAAMd,EAAA,MAAKF,GAAAiB,GAAL,WAA2B,KAAK,yBAGtC,KAAK,aAAa,IAClB,KAAK,kBAAkB,IACvB,KAAK,mBAAmB,IACxB,KAAK,oBAAoB,IACzB,KAAK,gBAAgB,IACrB,KAAK,mBAAmB;AAE1B,GAEMA,mBAAsBC,GAAqB;AAChD,UAAQ,IAAI,gCAAgCA,CAAW,GACvD,KAAK,gBAAgB,IACrB,KAAK,mBAAmB;AAExB,MAAI;AACH,YAAQ,IAAI,yBAAyB;AAErC,UAAMC,IAAQ,OADM,MAAM,KAAK,WAAWC,EAAgB,GAC1B,eAAA;AAChC,YAAQ,IAAI,2BAA2B;AAEvC,UAAMC,IAAW,MAAM;AAAA,MACtB,qEAAqEH,CAAW;AAAA,MAChF;AAAA,QACC,QAAQ;AAAA,QACR,SAAS;AAAA,UACR,gBAAgB;AAAA,UAChB,eAAe,UAAUC,CAAK;AAAA,QAAA;AAAA,MAC/B;AAAA,IACD;AAKD,QAFA,QAAQ,IAAI,wBAAwBE,EAAS,MAAM,GAE/C,CAACA,EAAS,IAAI;AACjB,YAAMC,IAAQ,MAAMD,EAAS,KAAA;AAC7B,cAAQ,MAAM,cAAcC,CAAK,GACjC,KAAK,mBAAmBA,EAAM,SAAS;AACvC;AAAA,IACD;AAEA,UAAMC,IAAS,MAAMF,EAAS,KAAA;AAC9B,YAAQ,IAAI,sBAAsBE,CAAM,GAGxC,KAAK,aAAaA,EAAO,SAAS,IAClC,KAAK,kBAAkBA,EAAO,SAAS,IACvC,KAAK,mBAAmBA,EAAO,eAAe,IAE9C,QAAQ,IAAI,uBAAuB,KAAK,YAAY,gBAAgB,KAAK,gBAAgB,GAGrFA,EAAO,SAAS,CAAC,KAAK,kBACzB,KAAK,gBAAgBA,EAAO,OAC5B,QAAQ,IAAI,6BAA6B,KAAK,aAAa,IAI5D,MAAMrB,EAAA,MAAKF,GAAAwB,GAAL,WAA8BN,GAAaC;AAAA,EAClD,SAASG,GAAO;AACf,SAAK,mBAAmB,+CACxB,QAAQ,MAAM,yBAAyBA,CAAK;AAAA,EAC7C,UAAA;AACC,SAAK,gBAAgB,IACrB,QAAQ,IAAI,sCAAsC,KAAK,aAAa,GAEpE,KAAK,cAAA;AAAA,EACN;AACD,GAEME,IAAA,eAAyBN,GAAqBC,GAAe;;AAClE,MAAI;AACH,YAAQ,IAAI,+BAA+B;AAC3C,UAAME,IAAW,MAAM;AAAA,MACtB,sEAAsEH,CAAW;AAAA,MACjF;AAAA,QACC,QAAQ;AAAA,QACR,SAAS;AAAA,UACR,gBAAgB;AAAA,UAChB,eAAe,UAAUC,CAAK;AAAA,QAAA;AAAA,MAC/B;AAAA,IACD;AAGD,QAAIE,EAAS,IAAI;AAChB,YAAME,IAAS,MAAMF,EAAS,KAAA;AAC9B,cAAQ,IAAI,+BAA+BE,CAAM,GACjD,QAAQ,IAAI,UAAUA,EAAO,KAAK,GAClC,QAAQ,IAAI,aAAaA,EAAO,QAAQ,GACxC,QAAQ,IAAI,sBAAqB1B,IAAA0B,EAAO,aAAP,gBAAA1B,EAAiB,UAAU,GAAG,IAAI,GAGnE,KAAK,oBAAoB0B,EAAO,YAAY;AAAA,IAC7C,OAAO;AACN,YAAMD,IAAQ,MAAMD,EAAS,KAAA;AAC7B,cAAQ,IAAI,+BAA+BC,CAAK,GAChD,KAAK,oBAAoB;AAAA,IAC1B;AAAA,EACD,SAASA,GAAO;AACf,YAAQ,MAAM,+BAA+BA,CAAK,GAClD,KAAK,oBAAoB;AAAA,EAC1B;AACD,GAEAZ,IAAA,WAAc;;AACb,OAAK,QAAQ;AAAA,IACZ,MAAM,KAAK;AAAA,IACX,YAAY,KAAK;AAAA,IACjB,aAAa,KAAK;AAAA,IAClB,WAAW,KAAK,cAAc;AAAA,IAC9B,WAAW,KAAK;AAAA,IAChB,gBAAgB,KAAK;AAAA,IACrB,iBAAiB,KAAK;AAAA,IACtB,kBAAkB,KAAK;AAAA,EAAA,IAExBb,IAAA,KAAK,iBAAL,QAAAA,EAAmB;AACpB,GAEAY,IAAA,WAAe;;AACd,GAAAZ,IAAA,KAAK,iBAAL,QAAAA,EAAmB;AACpB,GAEAU,IAAA,WAAkB;AACjB,UAAQ,KAAK,aAAA;AAAA,IACZ,KAAK;AACJ,aAAOL,EAAA,MAAKF,GAAAyB,GAAL;AAAA,IACR,KAAK;AACJ,aAAOvB,EAAA,MAAKF,GAAA0B,GAAL;AAAA,IACR,KAAK;AACJ,aAAOxB,EAAA,MAAKF,GAAA2B,GAAL;AAAA,IACR;AACC,aAAOC;AAAA,EAAA;AAEV,GAEAH,IAAA,WAAmB;AAClB,SAAOrB;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKOF,EAAA,MAAKF,GAAAe,EAAkB;AAAA;AAAA,OAEhCb,EAAA,MAAKF,GAAA6B,GAAL,UAA8B;AAAA;AAAA;AAAA;AAIpC,GAEAH,IAAA,WAAmB;AAClB,SAAOtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAMM,KAAK,UAAU;AAAA,eACf,CAAC,MAAsB,KAAK,aAAa,EAAE,OAAO,KAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAShF,GAEAuB,IAAA,WAAmB;AAClB,SAAOvB;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKO,CAAC,MAAmB;AAE7B,UAAMY,IADS,EAAE,OACQ;AACzB,SAAK,uBAAuBA,EAAU,SAAS,IAAIA,EAAU,CAAC,IAAI;AAAA,EACnE,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASN,GAEAa,IAAA,WAA0B;AACzB,SAAI,KAAK,gBACDzB;AAAA;AAAA;AAAA,aAMJ,KAAK,mBACDA;AAAA;AAAA,YAEE,KAAK,gBAAgB;AAAA,aAI3B,KAAK,aACDA;AAAA;AAAA;AAAA,aAMDwB;AACR,GAEApB,IAAA,WAA0B;AACzB,SAAI,CAAC,KAAK,cAAc,CAAC,KAAK,oBAAoB,CAAC,KAAK,oBAChDoB,IAGDxB;AAAA;AAAA;AAAA,oCAG2B,KAAK,cAAc,SAAS;AAAA;AAAA;AAAA,0CAGtB,KAAK,oBAAoB,SAAS;AAAA;AAAA,MAEtE,KAAK,oBACJA;AAAA;AAAA,wCAEiC,KAAK,kBAAkB,UAAU,GAAG,GAAG,CAAC,GAAG,KAAK,kBAAkB,SAAS,MAAM,QAAQ,EAAE;AAAA,gBAE5HwB,CAAO;AAAA;AAAA;AAGb,GAEAzB,KAAA,WAAyB;AACxB,MAAI,CAAC,KAAK,iBAAiB,KAAK,cAAe,QAAO;AAEtD,UAAQ,KAAK,aAAA;AAAA,IACZ,KAAK;AACJ,aAAO,CAAC,CAAC,KAAK;AAAA,IACf,KAAK;AAAA,IACL,KAAK;AAEJ,aAAO;AAAA,IACR;AACC,aAAO;AAAA,EAAA;AAEV,GAvUYP,IAANkC,EAAAnB,GAAA,gCADPjB,GACaE,IAoYZA,EAAgB,SAAS;AAAA,EACxBmC;AAAA,EACAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAtYKC,EAAAtB,GAAA,GAAMf;AAAN,IAAMsC,IAANtC;"}