{"version":3,"file":"section-rules-editor-modal.element-CPNZ1fKu.js","sources":["../src/workflow.types.ts","../src/section-rules-editor-modal.element.ts"],"sourcesContent":["// ============================================================================\r\n// Source Config Types (source.json)\r\n// ============================================================================\r\n\r\nexport interface SourceConfig {\r\n\tversion: string;\r\n\tsourceTypes: string[];\r\n\tglobals?: SourceGlobals;\r\n\t/** Top-level page selection: \"all\" or array of page numbers. */\r\n\tpages?: number[] | 'all';\r\n\tsections: SourceSection[];\r\n\t/** Rules for breaking transform sections into individually-mappable roles, keyed by section ID. */\r\n\tsectionRules?: Record<string, SectionRuleSet>;\r\n\t/** Rules for breaking area elements into individually-mappable sections, keyed by area name in kebab-case. */\r\n\tareaRules?: Record<string, SectionRuleSet>;\r\n}\r\n\r\n// ============================================================================\r\n// Section Rules Types (stored in source.json under sectionRules)\r\n// ============================================================================\r\n\r\nexport interface SectionRuleSet {\r\n\trules: SectionRule[];\r\n}\r\n\r\nexport type RuleAction = 'sectionTitle' | 'sectionContent' | 'exclude';\r\n\r\n/** Legacy action names still accepted from existing source.json files */\r\nexport type LegacyRuleAction = 'createSection' | 'setAsHeading' | 'addAsContent' | 'addAsList';\r\n\r\n/**\r\n * Markdown format for sectionContent action.\r\n * Determines what Markdown syntax the matched content produces.\r\n */\r\nexport type RuleContentFormat =\r\n\t| 'paragraph'\r\n\t| 'heading1'\r\n\t| 'heading2'\r\n\t| 'heading3'\r\n\t| 'bulletListItem'\r\n\t| 'numberedListItem';\r\n\r\nexport interface SectionRule {\r\n\trole: string;\r\n\taction: RuleAction | LegacyRuleAction;\r\n\t/** Markdown format — only meaningful when action = sectionContent */\r\n\tformat?: RuleContentFormat;\r\n\tconditions: RuleCondition[];\r\n\t/** UNLESS conditions — if any single exception matches, the rule does not apply. */\r\n\texceptions?: RuleCondition[];\r\n}\r\n\r\n/** Normalize legacy action names to v2. Returns [action, effectiveFormat]. */\r\nexport function normalizeAction(action: string, format?: RuleContentFormat): [RuleAction, RuleContentFormat | undefined] {\r\n\tswitch (action) {\r\n\t\tcase 'createSection':\r\n\t\tcase 'setAsHeading':\r\n\t\t\treturn ['sectionTitle', undefined];\r\n\t\tcase 'addAsContent':\r\n\t\t\treturn ['sectionContent', format ?? 'paragraph'];\r\n\t\tcase 'addAsList':\r\n\t\t\treturn ['sectionContent', format ?? 'bulletListItem'];\r\n\t\tcase 'sectionTitle':\r\n\t\t\treturn ['sectionTitle', undefined];\r\n\t\tcase 'sectionContent':\r\n\t\t\treturn ['sectionContent', format ?? 'paragraph'];\r\n\t\tcase 'exclude':\r\n\t\t\treturn ['exclude', undefined];\r\n\t\tdefault:\r\n\t\t\treturn ['sectionContent', format ?? 'paragraph'];\r\n\t}\r\n}\r\n\r\nexport interface RuleCondition {\r\n\ttype: RuleConditionType;\r\n\tvalue?: string | number;\r\n}\r\n\r\nexport type RuleConditionType =\r\n\t| 'textBeginsWith'\r\n\t| 'textEndsWith'\r\n\t| 'textContains'\r\n\t| 'textEquals'\r\n\t| 'textMatchesPattern'\r\n\t| 'fontSizeEquals'\r\n\t| 'fontSizeAbove'\r\n\t| 'fontSizeBelow'\r\n\t| 'fontNameContains'\r\n\t| 'fontNameEquals'\r\n\t| 'colorEquals'\r\n\t| 'positionFirst'\r\n\t| 'positionLast';\r\n\r\n/**\r\n * Pattern for identifying section heading elements within an area.\r\n * Null/undefined = auto-detect (bodySize * 1.15).\r\n * Empty conditions = flat section (no grouping).\r\n * Populated conditions = user-defined from teach-by-example.\r\n */\r\nexport interface SectionPattern {\r\n\tconditions: RuleCondition[];\r\n}\r\n\r\nexport interface SourceGlobals {\r\n\tcolumnDetection?: ColumnDetectionConfig;\r\n\tpageRange?: PageRangeConfig;\r\n}\r\n\r\nexport interface ColumnDetectionConfig {\r\n\tenabled: boolean;\r\n\tthresholdPercent: number;\r\n}\r\n\r\nexport interface PageRangeConfig {\r\n\tstart: number;\r\n\tend: number | 'last';\r\n}\r\n\r\nexport interface SourceSection {\r\n\tkey: string;\r\n\tlabel: string;\r\n\tdescription?: string;\r\n\tstrategy: ExtractionStrategy;\r\n\toutputFormat: 'text' | 'markdown' | 'html';\r\n\trequired?: boolean;\r\n\tpages?: number[] | 'all';\r\n\tcolumnFilter?: boolean;\r\n\toccurrence?: 'first' | 'last' | 'all';\r\n\tstrategyParams?: StrategyParams;\r\n}\r\n\r\nexport type ExtractionStrategy =\r\n\t| 'largestFont'\r\n\t| 'regex'\r\n\t| 'betweenPatterns'\r\n\t| 'region'\r\n\t| 'afterLabel'\r\n\t| 'firstHeading'\r\n\t| 'firstParagraph'\r\n\t| 'cssSelector'\r\n\t| 'xpath';\r\n\r\nexport interface StrategyParams {\r\n\t// largestFont\r\n\tfontSizeThreshold?: number;\r\n\r\n\t// regex\r\n\tpattern?: string;\r\n\tflags?: string;\r\n\tcaptureGroup?: number;\r\n\r\n\t// betweenPatterns\r\n\tstartPattern?: string;\r\n\tstopPatterns?: string[];\r\n\tincludeStartLine?: boolean;\r\n\theadingLevel?: 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6';\r\n\r\n\t// region\r\n\tregion?: RegionConfig;\r\n\r\n\t// firstHeading (markdown)\r\n\tlevel?: number;\r\n\r\n\t// afterLabel\r\n\tlabel?: string;\r\n\tlabelPattern?: string;\r\n\textractMode?: 'sameLine' | 'nextLine' | 'untilBlank';\r\n\r\n\t// cssSelector (web)\r\n\tselector?: string;\r\n\tattribute?: string;\r\n\r\n\t// xpath (web/Word)\r\n\txpath?: string;\r\n}\r\n\r\nexport interface RegionConfig {\r\n\tx?: { min?: number; max?: number };\r\n\ty?: { min?: number; max?: number };\r\n\tunit?: 'percent' | 'points';\r\n}\r\n\r\n// ============================================================================\r\n// Destination Config Types (destination.json)\r\n// ============================================================================\r\n\r\nexport interface DestinationConfig {\r\n\tversion: string;\r\n\tdocumentTypeAlias: string;\r\n\tdocumentTypeName?: string;\r\n\tblueprintId?: string;\r\n\tblueprintName?: string;\r\n\tfields: DestinationField[];\r\n\tblockGrids?: DestinationBlockGrid[];\r\n}\r\n\r\nexport interface DestinationField {\r\n\tkey: string;\r\n\talias: string;\r\n\tlabel: string;\r\n\tdescription?: string;\r\n\ttype: FieldType;\r\n\ttab?: string;\r\n\tmandatory?: boolean;\r\n\tacceptsFormats?: ContentFormat[];\r\n}\r\n\r\nexport type FieldType =\r\n\t| 'text'\r\n\t| 'textArea'\r\n\t| 'richText'\r\n\t| 'number'\r\n\t| 'date'\r\n\t| 'boolean'\r\n\t| 'mediaPicker'\r\n\t| 'contentPicker'\r\n\t| 'blockGrid'\r\n\t| 'blockList';\r\n\r\nexport type ContentFormat = 'text' | 'markdown' | 'html';\r\n\r\nexport interface DestinationBlockGrid {\r\n\tkey: string;\r\n\talias: string;\r\n\tlabel: string;\r\n\tdescription?: string;\r\n\tblocks: DestinationBlock[];\r\n}\r\n\r\nexport interface DestinationBlock {\r\n\tkey: string;\r\n\tcontentTypeAlias: string;\r\n\tcontentTypeKey?: string;\r\n\tlabel: string;\r\n\tdescription?: string;\r\n\tidentifyBy?: BlockIdentifier;\r\n\tproperties?: BlockProperty[];\r\n}\r\n\r\nexport interface BlockIdentifier {\r\n\tproperty: string;\r\n\tvalue: string;\r\n}\r\n\r\nexport interface BlockProperty {\r\n\tkey: string;\r\n\talias: string;\r\n\tlabel?: string;\r\n\ttype: FieldType;\r\n\tacceptsFormats?: ContentFormat[];\r\n}\r\n\r\n// ============================================================================\r\n// Map Config Types (map.json)\r\n// ============================================================================\r\n\r\nexport interface MapConfig {\r\n\tversion: string;\r\n\tname?: string;\r\n\tdescription?: string;\r\n\tmappings: SectionMapping[];\r\n}\r\n\r\nexport interface SectionMapping {\r\n\tsource: string;\r\n\tdestinations: MappingDestination[];\r\n\tenabled?: boolean;\r\n\tcomment?: string;\r\n}\r\n\r\nexport interface MappingDestination {\r\n\ttarget: string;\r\n\tblockKey?: string;\r\n\ttransforms?: MappingTransform[];\r\n}\r\n\r\nexport interface MappingTransform {\r\n\ttype: TransformType;\r\n\tparams?: TransformParams;\r\n}\r\n\r\nexport type TransformType =\r\n\t| 'convertMarkdownToHtml'\r\n\t| 'convertHtmlToMarkdown'\r\n\t| 'truncate'\r\n\t| 'template'\r\n\t| 'regex'\r\n\t| 'trim'\r\n\t| 'uppercase'\r\n\t| 'lowercase'\r\n\t| 'stripHtml';\r\n\r\nexport interface TransformParams {\r\n\tmaxLength?: number;\r\n\tsuffix?: string;\r\n\ttemplate?: string;\r\n\tpattern?: string;\r\n\treplacement?: string;\r\n}\r\n\r\n// ============================================================================\r\n// Combined Document Type Config\r\n// ============================================================================\r\n\r\nexport interface DocumentTypeConfig {\r\n\tfolderPath: string;\r\n\tdocumentTypeAlias: string;\r\n\tsources: Record<string, SourceConfig>;\r\n\tdestination: DestinationConfig;\r\n\tmap: MapConfig;\r\n}\r\n\r\n// ============================================================================\r\n// Rich Extraction Types (sample-extraction.json)\r\n// ============================================================================\r\n\r\nexport interface RichExtractionResult {\r\n\tversion: string;\r\n\tsourceType: string;\r\n\tsource: ExtractionSource;\r\n\telements: ExtractionElement[];\r\n}\r\n\r\nexport interface ExtractionSource {\r\n\tfileName: string;\r\n\tmediaKey: string;\r\n\textractedDate: string;\r\n\ttotalPages: number;\r\n\t/** Which pages were extracted. Null/undefined = all pages. */\r\n\textractedPages?: number[] | null;\r\n}\r\n\r\nexport interface ExtractionElement {\r\n\tid: string;\r\n\tpage: number;\r\n\ttext: string;\r\n\tmetadata: ElementMetadata;\r\n}\r\n\r\nexport interface ElementMetadata {\r\n\tfontSize: number;\r\n\tfontName: string;\r\n\tposition: { x: number; y: number };\r\n\tboundingBox: { left: number; top: number; width: number; height: number };\r\n\tcolor: string;\r\n}\r\n\r\n// ============================================================================\r\n// Visual Grouping Types (frontend-only, computed from extraction metadata)\r\n// ============================================================================\r\n\r\nexport interface VisualGroup {\r\n\theading: ExtractionElement | null;\r\n\tchildren: ExtractionElement[];\r\n}\r\n\r\n// ============================================================================\r\n// Area Detection Types (area-detection.json — area-based hierarchical extraction)\r\n// ============================================================================\r\n\r\nexport interface AreaDetectionResult {\r\n\ttotalPages: number;\r\n\tpages: PageAreas[];\r\n\tdiagnostics: AreaDiagnosticInfo;\r\n}\r\n\r\nexport interface PageAreas {\r\n\tpage: number;\r\n\tareas: DetectedArea[];\r\n}\r\n\r\nexport interface DetectedArea {\r\n\tname?: string;\r\n\tcolor: string;\r\n\tboundingBox: { left: number; top: number; width: number; height: number };\r\n\tpage: number;\r\n\tsections: DetectedSection[];\r\n\ttotalElements: number;\r\n\tsectionPattern?: SectionPattern;\r\n}\r\n\r\nexport interface DetectedSection {\r\n\theading: AreaElement | null;\r\n\tchildren: AreaElement[];\r\n}\r\n\r\nexport interface AreaElement {\r\n\tid: string;\r\n\ttext: string;\r\n\tfontSize: number;\r\n\tfontName: string;\r\n\tcolor: string;\r\n\tboundingBox: { left: number; top: number; width: number; height: number };\r\n}\r\n\r\nexport interface AreaDiagnosticInfo {\r\n\ttotalPathsFound: number;\r\n\tpathsAfterFiltering: number;\r\n\tareasDetected: number;\r\n\telementsInAreas: number;\r\n}\r\n\r\n// ============================================================================\r\n// Transform Result Types (transform.json — assembled Markdown per section)\r\n// ============================================================================\r\n\r\nexport interface TransformResult {\r\n\tversion: string;\r\n\tsections: TransformedSection[];\r\n\tdiagnostics: TransformDiagnostics;\r\n}\r\n\r\nexport interface TransformedSection {\r\n\tid: string;\r\n\toriginalHeading: string | null;\r\n\theading: string | null;\r\n\tcontent: string;\r\n\tpattern: 'bulletList' | 'paragraph' | 'subHeaded' | 'preamble' | 'mixed' | 'role';\r\n\tpage: number;\r\n\tareaColor: string | null;\r\n\tareaName: string | null;\r\n\tchildCount: number;\r\n\tincluded: boolean;\r\n}\r\n\r\nexport interface TransformDiagnostics {\r\n\ttotalSections: number;\r\n\tbulletListSections: number;\r\n\tparagraphSections: number;\r\n\tsubHeadedSections: number;\r\n\tpreambleSections: number;\r\n\troleSections: number;\r\n}\r\n\r\n// ============================================================================\r\n// Area Template Types (area-template.json — user-defined extraction areas)\r\n// ============================================================================\r\n\r\nexport interface AreaTemplate {\r\n\ttemplateName: string;\r\n\tsourceFile: string;\r\n\tpageSize: { width: number; height: number };\r\n\tcreatedAt: string;\r\n\tareas: AreaDefinition[];\r\n}\r\n\r\nexport interface AreaDefinition {\r\n\tname: string;\r\n\tproperty: string;\r\n\tpage: number;\r\n\ttype: string;\r\n\tbounds: AreaBounds;\r\n\tcolor: string;\r\n\tsectionPattern?: SectionPattern;\r\n\texpectedSections: string[];\r\n\tnotes: string;\r\n}\r\n\r\nexport interface AreaBounds {\r\n\tx: number;\r\n\ty: number;\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\n// ============================================================================\r\n// API Response Types\r\n// ============================================================================\r\n\r\nexport interface ExtractSectionsResponse {\r\n\tsections: Record<string, string>;\r\n\tconfig: DocumentTypeConfig;\r\n}\r\n\r\nexport interface InferSectionPatternResponse {\r\n\tpattern: SectionPattern;\r\n\tmatchingElementIds: string[];\r\n\tclickedElementId: string;\r\n\ttotalElements: number;\r\n}\r\n","import type { SectionRulesEditorModalData, SectionRulesEditorModalValue } from './section-rules-editor-modal.token.js';\r\nimport type { SectionRule, RuleCondition, RuleConditionType, RuleAction, RuleContentFormat, AreaElement } from './workflow.types.js';\r\nimport { normalizeAction } from './workflow.types.js';\r\nimport { html, css, state, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport { customElement } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\n\r\n/** Friendly labels for condition types */\r\nconst CONDITION_LABELS: Record<RuleConditionType, string> = {\r\n\ttextBeginsWith: 'Text begins with',\r\n\ttextEndsWith: 'Text ends with',\r\n\ttextContains: 'Text contains',\r\n\ttextEquals: 'Text equals',\r\n\ttextMatchesPattern: 'Text matches pattern',\r\n\tfontSizeEquals: 'Font size equals',\r\n\tfontSizeAbove: 'Font size above',\r\n\tfontSizeBelow: 'Font size below',\r\n\tfontNameContains: 'Font name contains',\r\n\tfontNameEquals: 'Font name equals',\r\n\tcolorEquals: 'Color equals',\r\n\tpositionFirst: 'Position: first',\r\n\tpositionLast: 'Position: last',\r\n};\r\n\r\n/** Condition types that don't need a value input */\r\nconst VALUELESS_CONDITIONS: RuleConditionType[] = ['positionFirst', 'positionLast'];\r\n\r\n/** All available condition types */\r\nconst ALL_CONDITION_TYPES: RuleConditionType[] = [\r\n\t'textBeginsWith', 'textEndsWith', 'textContains', 'textEquals', 'textMatchesPattern',\r\n\t'fontSizeEquals', 'fontSizeAbove', 'fontSizeBelow',\r\n\t'fontNameContains', 'fontNameEquals', 'colorEquals',\r\n\t'positionFirst', 'positionLast',\r\n];\r\n\r\n/** Friendly labels for rule actions */\r\nconst ACTION_LABELS: Record<RuleAction, string> = {\r\n\tsectionTitle: 'Section Title',\r\n\tsectionContent: 'Section Content',\r\n\texclude: 'Exclude',\r\n};\r\n\r\n/** All available rule actions */\r\nconst ALL_ACTIONS: RuleAction[] = ['sectionTitle', 'sectionContent', 'exclude'];\r\n\r\n/** Friendly labels for content format (conditional dropdown when action = sectionContent) */\r\nconst FORMAT_LABELS: Record<RuleContentFormat, string> = {\r\n\tparagraph: 'Paragraph',\r\n\theading1: 'Heading 1',\r\n\theading2: 'Heading 2',\r\n\theading3: 'Heading 3',\r\n\tbulletListItem: 'Bullet List',\r\n\tnumberedListItem: 'Numbered List',\r\n};\r\n\r\n/** All available format values */\r\nconst ALL_FORMATS: RuleContentFormat[] = ['paragraph', 'heading1', 'heading2', 'heading3', 'bulletListItem', 'numberedListItem'];\r\n\r\n@customElement('up-doc-section-rules-editor-modal')\r\nexport class UpDocSectionRulesEditorModalElement extends UmbModalBaseElement<SectionRulesEditorModalData, SectionRulesEditorModalValue> {\r\n\t@state() private _rules: SectionRule[] = [];\r\n\t/** Track collapsed state per rule section: \"conditions-0\", \"exceptions-1\", etc. */\r\n\t@state() private _collapsed: Set<string> = new Set();\r\n\r\n\t#isCollapsed(section: string, ruleIdx: number): boolean {\r\n\t\treturn this._collapsed.has(`${section}-${ruleIdx}`);\r\n\t}\r\n\r\n\t#toggleCollapsed(section: string, ruleIdx: number) {\r\n\t\tconst key = `${section}-${ruleIdx}`;\r\n\t\tconst next = new Set(this._collapsed);\r\n\t\tif (next.has(key)) {\r\n\t\t\tnext.delete(key);\r\n\t\t} else {\r\n\t\t\tnext.add(key);\r\n\t\t}\r\n\t\tthis._collapsed = next;\r\n\t}\r\n\r\n\toverride firstUpdated() {\r\n\t\t// Deep clone existing rules so edits don't mutate the original\r\n\t\tif (this.data?.existingRules?.rules?.length) {\r\n\t\t\tconst cloned: SectionRule[] = JSON.parse(JSON.stringify(this.data.existingRules.rules));\r\n\t\t\t// Normalize legacy action names to v2\r\n\t\t\tthis._rules = cloned.map((rule) => {\r\n\t\t\t\tconst [action, format] = normalizeAction(rule.action, rule.format);\r\n\t\t\t\treturn { ...rule, action, format };\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tget #elements(): AreaElement[] {\r\n\t\treturn this.data?.elements ?? [];\r\n\t}\r\n\r\n\tget #sectionHeading(): string {\r\n\t\treturn this.data?.sectionHeading ?? 'Section';\r\n\t}\r\n\r\n\t// ===== Rule evaluation (first-match-wins) =====\r\n\r\n\t/** Evaluate all rules against elements. Returns a map of elementId -> ruleIndex */\r\n\t#evaluateRules(): Map<string, number> {\r\n\t\tconst claimed = new Map<string, number>();\r\n\t\tconst elements = this.#elements;\r\n\r\n\t\tfor (let ruleIdx = 0; ruleIdx < this._rules.length; ruleIdx++) {\r\n\t\t\tconst rule = this._rules[ruleIdx];\r\n\t\t\tif (rule.conditions.length === 0) continue;\r\n\r\n\t\t\tfor (let elIdx = 0; elIdx < elements.length; elIdx++) {\r\n\t\t\t\tconst el = elements[elIdx];\r\n\t\t\t\tif (claimed.has(el.id)) continue; // already claimed by an earlier rule\r\n\r\n\t\t\t\tif (this.#elementMatchesAllConditions(el, rule.conditions, elIdx, elements.length)) {\r\n\t\t\t\t\tclaimed.set(el.id, ruleIdx);\r\n\t\t\t\t\t// No break — a rule can match multiple elements (e.g. repeating section headings)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn claimed;\r\n\t}\r\n\r\n\t#elementMatchesAllConditions(el: AreaElement, conditions: RuleCondition[], index: number, total: number): boolean {\r\n\t\treturn conditions.every((c) => this.#elementMatchesCondition(el, c, index, total));\r\n\t}\r\n\r\n\t#elementMatchesCondition(el: AreaElement, condition: RuleCondition, index: number, total: number): boolean {\r\n\t\tconst val = String(condition.value ?? '');\r\n\t\tconst numVal = Number(condition.value);\r\n\r\n\t\tswitch (condition.type) {\r\n\t\t\tcase 'textBeginsWith':\r\n\t\t\t\treturn el.text.toLowerCase().startsWith(val.toLowerCase());\r\n\t\t\tcase 'textEndsWith':\r\n\t\t\t\treturn el.text.toLowerCase().endsWith(val.toLowerCase());\r\n\t\t\tcase 'textContains':\r\n\t\t\t\treturn el.text.toLowerCase().includes(val.toLowerCase());\r\n\t\t\tcase 'textMatchesPattern':\r\n\t\t\t\ttry { return new RegExp(val, 'i').test(el.text); } catch { return false; }\r\n\t\t\tcase 'fontSizeEquals':\r\n\t\t\t\treturn !isNaN(numVal) && Math.abs(el.fontSize - numVal) < 0.5;\r\n\t\t\tcase 'fontSizeAbove':\r\n\t\t\t\treturn !isNaN(numVal) && el.fontSize > numVal;\r\n\t\t\tcase 'fontSizeBelow':\r\n\t\t\t\treturn !isNaN(numVal) && el.fontSize < numVal;\r\n\t\t\tcase 'fontNameContains':\r\n\t\t\t\treturn el.fontName.toLowerCase().includes(val.toLowerCase());\r\n\t\t\tcase 'colorEquals':\r\n\t\t\t\treturn el.color.toLowerCase() === val.toLowerCase();\r\n\t\t\tcase 'positionFirst':\r\n\t\t\t\treturn index === 0;\r\n\t\t\tcase 'positionLast':\r\n\t\t\t\treturn index === total - 1;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t// ===== Auto-populate conditions from an element =====\r\n\r\n\t#autoPopulateConditions(el: AreaElement, elIndex: number, total: number): RuleCondition[] {\r\n\t\tconst conditions: RuleCondition[] = [];\r\n\r\n\t\t// Font size\r\n\t\tconditions.push({ type: 'fontSizeEquals', value: el.fontSize });\r\n\r\n\t\t// Font name\r\n\t\tif (el.fontName) {\r\n\t\t\tconditions.push({ type: 'fontNameContains', value: el.fontName });\r\n\t\t}\r\n\r\n\t\t// Color (skip black/very dark as it's the default)\r\n\t\tif (el.color && el.color.toLowerCase() !== '#000000' && el.color.toLowerCase() !== '#000') {\r\n\t\t\tconditions.push({ type: 'colorEquals', value: el.color });\r\n\t\t}\r\n\r\n\t\t// Text prefix — if text contains a colon, use \"begins with\" up to the colon\r\n\t\tconst colonIdx = el.text.indexOf(':');\r\n\t\tif (colonIdx > 0 && colonIdx < 30) {\r\n\t\t\tconditions.push({ type: 'textBeginsWith', value: el.text.substring(0, colonIdx + 1) });\r\n\t\t}\r\n\r\n\t\t// Position\r\n\t\tif (elIndex === 0) {\r\n\t\t\tconditions.push({ type: 'positionFirst' });\r\n\t\t} else if (elIndex === total - 1) {\r\n\t\t\tconditions.push({ type: 'positionLast' });\r\n\t\t}\r\n\r\n\t\treturn conditions;\r\n\t}\r\n\r\n\t// ===== Rule CRUD =====\r\n\r\n\t#addRule() {\r\n\t\tthis._rules = [...this._rules, { role: '', action: 'sectionTitle' as RuleAction, conditions: [] }];\r\n\t}\r\n\r\n\t#removeRule(ruleIdx: number) {\r\n\t\tthis._rules = this._rules.filter((_, i) => i !== ruleIdx);\r\n\t}\r\n\r\n\t#createRuleFromElement(el: AreaElement, elIndex: number) {\r\n\t\tconst conditions = this.#autoPopulateConditions(el, elIndex, this.#elements.length);\r\n\t\t// Derive a role name suggestion from text (kebab-case first few words)\r\n\t\tconst roleSuggestion = el.text\r\n\t\t\t.split(/[\\s:,]+/)\r\n\t\t\t.slice(0, 3)\r\n\t\t\t.join('-')\r\n\t\t\t.toLowerCase()\r\n\t\t\t.replace(/[^a-z0-9-]/g, '');\r\n\t\tthis._rules = [...this._rules, { role: roleSuggestion, action: 'sectionTitle' as RuleAction, conditions }];\r\n\t}\r\n\r\n\t#updateRoleName(ruleIdx: number, value: string) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tupdated[ruleIdx] = { ...updated[ruleIdx], role: value };\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#updateAction(ruleIdx: number, value: RuleAction) {\r\n\t\tconst updated = [...this._rules];\r\n\t\t// Always preserve format — it's now an independent section\r\n\t\tupdated[ruleIdx] = { ...updated[ruleIdx], action: value, format: updated[ruleIdx].format ?? 'paragraph' };\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#updateFormat(ruleIdx: number, value: RuleContentFormat) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tupdated[ruleIdx] = { ...updated[ruleIdx], format: value };\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#addCondition(ruleIdx: number) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.conditions = [...rule.conditions, { type: 'textBeginsWith', value: '' }];\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#removeCondition(ruleIdx: number, condIdx: number) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.conditions = rule.conditions.filter((_, i) => i !== condIdx);\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#updateConditionType(ruleIdx: number, condIdx: number, type: RuleConditionType) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.conditions = [...rule.conditions];\r\n\t\trule.conditions[condIdx] = {\r\n\t\t\ttype,\r\n\t\t\tvalue: VALUELESS_CONDITIONS.includes(type) ? undefined : rule.conditions[condIdx].value,\r\n\t\t};\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#updateConditionValue(ruleIdx: number, condIdx: number, value: string) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.conditions = [...rule.conditions];\r\n\t\tconst cond = rule.conditions[condIdx];\r\n\t\t// Store as number for font size conditions\r\n\t\tconst isNumeric = cond.type === 'fontSizeEquals' || cond.type === 'fontSizeAbove' || cond.type === 'fontSizeBelow';\r\n\t\trule.conditions[condIdx] = { ...cond, value: isNumeric && !isNaN(Number(value)) ? Number(value) : value };\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t// ===== Exception CRUD =====\r\n\r\n\t#addException(ruleIdx: number) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.exceptions = [...(rule.exceptions ?? []), { type: 'textContains' as RuleConditionType, value: '' }];\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#removeException(ruleIdx: number, excIdx: number) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.exceptions = (rule.exceptions ?? []).filter((_, i) => i !== excIdx);\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#updateExceptionType(ruleIdx: number, excIdx: number, type: RuleConditionType) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.exceptions = [...(rule.exceptions ?? [])];\r\n\t\trule.exceptions[excIdx] = {\r\n\t\t\ttype,\r\n\t\t\tvalue: VALUELESS_CONDITIONS.includes(type) ? undefined : rule.exceptions[excIdx].value,\r\n\t\t};\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#updateExceptionValue(ruleIdx: number, excIdx: number, value: string) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.exceptions = [...(rule.exceptions ?? [])];\r\n\t\tconst exc = rule.exceptions[excIdx];\r\n\t\tconst isNumeric = exc.type === 'fontSizeEquals' || exc.type === 'fontSizeAbove' || exc.type === 'fontSizeBelow';\r\n\t\trule.exceptions[excIdx] = { ...exc, value: isNumeric && !isNaN(Number(value)) ? Number(value) : value };\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t// ===== Submit =====\r\n\r\n\t#onSubmit() {\r\n\t\tthis.value = { rules: { rules: this._rules } };\r\n\t\tthis.modalContext?.submit();\r\n\t}\r\n\r\n\t#onClose() {\r\n\t\tthis.modalContext?.reject();\r\n\t}\r\n\r\n\t// ===== Rendering =====\r\n\r\n\t#renderConditionRow(ruleIdx: number, condIdx: number, condition: RuleCondition) {\r\n\t\tconst isValueless = VALUELESS_CONDITIONS.includes(condition.type);\r\n\t\treturn html`\r\n\t\t\t<div class=\"condition-row\">\r\n\t\t\t\t<select\r\n\t\t\t\t\tclass=\"condition-type-select\"\r\n\t\t\t\t\t.value=${condition.type}\r\n\t\t\t\t\t@change=${(e: Event) => this.#updateConditionType(ruleIdx, condIdx, (e.target as HTMLSelectElement).value as RuleConditionType)}>\r\n\t\t\t\t\t${ALL_CONDITION_TYPES.map((t) => html`\r\n\t\t\t\t\t\t<option value=${t} ?selected=${t === condition.type}>${CONDITION_LABELS[t]}</option>\r\n\t\t\t\t\t`)}\r\n\t\t\t\t</select>\r\n\t\t\t\t${isValueless ? nothing : html`\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tclass=\"condition-value-input\"\r\n\t\t\t\t\t\tplaceholder=\"Value...\"\r\n\t\t\t\t\t\t.value=${String(condition.value ?? '')}\r\n\t\t\t\t\t\t@input=${(e: Event) => this.#updateConditionValue(ruleIdx, condIdx, (e.target as HTMLInputElement).value)} />\r\n\t\t\t\t`}\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tcompact\r\n\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\tlabel=\"Remove condition\"\r\n\t\t\t\t\t@click=${() => this.#removeCondition(ruleIdx, condIdx)}>\r\n\t\t\t\t\t<uui-icon name=\"icon-trash\"></uui-icon>\r\n\t\t\t\t</uui-button>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderExceptionRow(ruleIdx: number, excIdx: number, exception: RuleCondition) {\r\n\t\tconst isValueless = VALUELESS_CONDITIONS.includes(exception.type);\r\n\t\treturn html`\r\n\t\t\t<div class=\"condition-row\">\r\n\t\t\t\t<select\r\n\t\t\t\t\tclass=\"condition-type-select\"\r\n\t\t\t\t\t.value=${exception.type}\r\n\t\t\t\t\t@change=${(e: Event) => this.#updateExceptionType(ruleIdx, excIdx, (e.target as HTMLSelectElement).value as RuleConditionType)}>\r\n\t\t\t\t\t${ALL_CONDITION_TYPES.map((t) => html`\r\n\t\t\t\t\t\t<option value=${t} ?selected=${t === exception.type}>${CONDITION_LABELS[t]}</option>\r\n\t\t\t\t\t`)}\r\n\t\t\t\t</select>\r\n\t\t\t\t${isValueless ? nothing : html`\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tclass=\"condition-value-input\"\r\n\t\t\t\t\t\tplaceholder=\"Value...\"\r\n\t\t\t\t\t\t.value=${String(exception.value ?? '')}\r\n\t\t\t\t\t\t@input=${(e: Event) => this.#updateExceptionValue(ruleIdx, excIdx, (e.target as HTMLInputElement).value)} />\r\n\t\t\t\t`}\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tcompact\r\n\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\tlabel=\"Remove exception\"\r\n\t\t\t\t\t@click=${() => this.#removeException(ruleIdx, excIdx)}>\r\n\t\t\t\t\t<uui-icon name=\"icon-trash\"></uui-icon>\r\n\t\t\t\t</uui-button>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderRuleCard(rule: SectionRule, ruleIdx: number, matchedElements: AreaElement[]) {\r\n\t\treturn html`\r\n\t\t\t<div class=\"rule-card\">\r\n\t\t\t\t<div class=\"rule-header\">\r\n\t\t\t\t\t<span class=\"rule-number\">${ruleIdx + 1}</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tclass=\"role-name-input\"\r\n\t\t\t\t\t\tplaceholder=\"Section name (e.g. tour-title)\"\r\n\t\t\t\t\t\t.value=${rule.role}\r\n\t\t\t\t\t\t@input=${(e: Event) => this.#updateRoleName(ruleIdx, (e.target as HTMLInputElement).value)} />\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\t\tcolor=\"danger\"\r\n\t\t\t\t\t\tlabel=\"Remove rule\"\r\n\t\t\t\t\t\t@click=${() => this.#removeRule(ruleIdx)}>\r\n\t\t\t\t\t\t<uui-icon name=\"icon-trash\"></uui-icon>\r\n\t\t\t\t\t</uui-button>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"conditions-area\">\r\n\t\t\t\t\t<div class=\"section-header collapsible\" @click=${() => this.#toggleCollapsed('conditions', ruleIdx)}>\r\n\t\t\t\t\t\t<uui-icon name=${this.#isCollapsed('conditions', ruleIdx) ? 'icon-navigation-right' : 'icon-navigation-down'}></uui-icon>\r\n\t\t\t\t\t\tConditions${rule.conditions.length > 0 ? ` (${rule.conditions.length})` : ''}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t${this.#isCollapsed('conditions', ruleIdx) ? nothing : html`\r\n\t\t\t\t\t\t${rule.conditions.map((cond, cIdx) => this.#renderConditionRow(ruleIdx, cIdx, cond))}\r\n\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\t\t\t\tlabel=\"Add condition\"\r\n\t\t\t\t\t\t\t@click=${() => this.#addCondition(ruleIdx)}>\r\n\t\t\t\t\t\t\t+ Add condition\r\n\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t`}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"exceptions-area\">\r\n\t\t\t\t\t<div class=\"section-header collapsible\" @click=${() => this.#toggleCollapsed('exceptions', ruleIdx)}>\r\n\t\t\t\t\t\t<uui-icon name=${this.#isCollapsed('exceptions', ruleIdx) ? 'icon-navigation-right' : 'icon-navigation-down'}></uui-icon>\r\n\t\t\t\t\t\tExceptions${(rule.exceptions ?? []).length > 0 ? ` (${(rule.exceptions ?? []).length})` : ''}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t${this.#isCollapsed('exceptions', ruleIdx) ? nothing : html`\r\n\t\t\t\t\t\t${(rule.exceptions ?? []).map((exc, eIdx) => this.#renderExceptionRow(ruleIdx, eIdx, exc))}\r\n\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\t\t\t\tlabel=\"Add exception\"\r\n\t\t\t\t\t\t\t@click=${() => this.#addException(ruleIdx)}>\r\n\t\t\t\t\t\t\t+ Add exception\r\n\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t`}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"action-area\">\r\n\t\t\t\t\t<div class=\"section-header collapsible\" @click=${() => this.#toggleCollapsed('action', ruleIdx)}>\r\n\t\t\t\t\t\t<uui-icon name=${this.#isCollapsed('action', ruleIdx) ? 'icon-navigation-right' : 'icon-navigation-down'}></uui-icon>\r\n\t\t\t\t\t\tAction\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t${this.#isCollapsed('action', ruleIdx) ? nothing : html`\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclass=\"action-select\"\r\n\t\t\t\t\t\t\t.value=${rule.action ?? 'sectionTitle'}\r\n\t\t\t\t\t\t\t@change=${(e: Event) => this.#updateAction(ruleIdx, (e.target as HTMLSelectElement).value as RuleAction)}>\r\n\t\t\t\t\t\t\t${ALL_ACTIONS.map((a) => html`\r\n\t\t\t\t\t\t\t\t<option value=${a} ?selected=${a === (rule.action ?? 'sectionTitle')}>${ACTION_LABELS[a]}</option>\r\n\t\t\t\t\t\t\t`)}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t`}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"format-area\">\r\n\t\t\t\t\t<div class=\"section-header collapsible\" @click=${() => this.#toggleCollapsed('format', ruleIdx)}>\r\n\t\t\t\t\t\t<uui-icon name=${this.#isCollapsed('format', ruleIdx) ? 'icon-navigation-right' : 'icon-navigation-down'}></uui-icon>\r\n\t\t\t\t\t\tFormat\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t${this.#isCollapsed('format', ruleIdx) ? nothing : html`\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclass=\"action-select\"\r\n\t\t\t\t\t\t\t.value=${rule.format ?? 'paragraph'}\r\n\t\t\t\t\t\t\t@change=${(e: Event) => this.#updateFormat(ruleIdx, (e.target as HTMLSelectElement).value as RuleContentFormat)}>\r\n\t\t\t\t\t\t\t${ALL_FORMATS.map((f) => html`\r\n\t\t\t\t\t\t\t\t<option value=${f} ?selected=${f === (rule.format ?? 'paragraph')}>${FORMAT_LABELS[f]}</option>\r\n\t\t\t\t\t\t\t`)}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t`}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"match-preview ${matchedElements.length > 0 ? 'matched' : 'no-match'}\">\r\n\t\t\t\t\t${matchedElements.length > 0\r\n\t\t\t\t\t\t? html`<uui-icon name=\"icon-check\"></uui-icon> Matched <strong>${matchedElements.length}&times;</strong>${matchedElements.length <= 5 ? html`: ${matchedElements.map((el, i) => html`${i > 0 ? html`, ` : nothing}<strong>${this.#truncate(el.text, 40)}</strong>`)}` : nothing}`\r\n\t\t\t\t\t\t: html`<uui-icon name=\"icon-alert\"></uui-icon> ${rule.conditions.length === 0 ? 'Add conditions to match elements' : 'No match'}`}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#truncate(text: string, max: number): string {\r\n\t\treturn text.length > max ? text.substring(0, max) + '...' : text;\r\n\t}\r\n\r\n\t#renderUnmatchedElements(claimed: Map<string, number>) {\r\n\t\tconst elements = this.#elements;\r\n\t\tconst unmatched = elements.filter((el) => !claimed.has(el.id));\r\n\t\tif (unmatched.length === 0) return nothing;\r\n\r\n\t\treturn html`\r\n\t\t\t<div class=\"unmatched-section\">\r\n\t\t\t\t<h4>Unmatched elements (${unmatched.length})</h4>\r\n\t\t\t\t${unmatched.map((el) => {\r\n\t\t\t\t\tconst elIndex = elements.indexOf(el);\r\n\t\t\t\t\treturn html`\r\n\t\t\t\t\t\t<div class=\"unmatched-element\">\r\n\t\t\t\t\t\t\t<div class=\"unmatched-text\">${this.#truncate(el.text, 80)}</div>\r\n\t\t\t\t\t\t\t<div class=\"unmatched-meta\">\r\n\t\t\t\t\t\t\t\t<span class=\"meta-badge\">${el.fontSize}pt</span>\r\n\t\t\t\t\t\t\t\t<span class=\"meta-badge\">${el.fontName}</span>\r\n\t\t\t\t\t\t\t\t${el.color !== '#000000' ? html`<span class=\"meta-badge\" style=\"border-left: 3px solid ${el.color};\">${el.color}</span>` : nothing}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\t\t\tlook=\"outline\"\r\n\t\t\t\t\t\t\t\tlabel=\"Define rule from this\"\r\n\t\t\t\t\t\t\t\t@click=${() => this.#createRuleFromElement(el, elIndex)}>\r\n\t\t\t\t\t\t\t\tDefine rule\r\n\t\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t`;\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tconst claimed = this.#evaluateRules();\r\n\r\n\t\t// Build ruleIdx -> all matched elements lookup\r\n\t\tconst ruleMatches = new Map<number, AreaElement[]>();\r\n\t\tfor (const [elId, ruleIdx] of claimed) {\r\n\t\t\tconst el = this.#elements.find((e) => e.id === elId);\r\n\t\t\tif (el) {\r\n\t\t\t\tconst existing = ruleMatches.get(ruleIdx) ?? [];\r\n\t\t\t\texisting.push(el);\r\n\t\t\t\truleMatches.set(ruleIdx, existing);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=\"Edit Sections: ${this.#sectionHeading}\">\r\n\t\t\t\t<div id=\"main\">\r\n\t\t\t\t\t<div class=\"section-info\">\r\n\t\t\t\t\t\t<span class=\"meta-badge\">${this.#elements.length} elements</span>\r\n\t\t\t\t\t\t<span class=\"meta-badge\">${this._rules.length} rules</span>\r\n\t\t\t\t\t\t<span class=\"meta-badge\">${claimed.size} matched</span>\r\n\t\t\t\t\t\t<span class=\"meta-badge\">${this.#elements.length - claimed.size} unmatched</span>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t${this._rules.map((rule, idx) => this.#renderRuleCard(rule, idx, ruleMatches.get(idx) ?? []))}\r\n\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\t\t\tlabel=\"Add rule\"\r\n\t\t\t\t\t\t@click=${this.#addRule}>\r\n\t\t\t\t\t\t+ Add another rule\r\n\t\t\t\t\t</uui-button>\r\n\r\n\t\t\t\t\t${this.#renderUnmatchedElements(claimed)}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div slot=\"actions\">\r\n\t\t\t\t\t<uui-button label=\"Close\" @click=${this.#onClose}>Close</uui-button>\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tlabel=\"Save\"\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\t@click=${this.#onSubmit}>\r\n\t\t\t\t\t\tSave\r\n\t\t\t\t\t</uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t#main {\r\n\t\t\t\tpadding: var(--uui-size-space-4);\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t.section-info {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t}\r\n\r\n\t\t\t.meta-badge {\r\n\t\t\t\tfont-size: 11px;\r\n\t\t\t\tfont-family: monospace;\r\n\t\t\t\tpadding: 1px 6px;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tbackground: var(--uui-color-surface-alt);\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t}\r\n\r\n\t\t\t/* Rule cards */\r\n\t\t\t.rule-card {\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t}\r\n\r\n\t\t\t.rule-header {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t\tbackground: var(--uui-color-surface-alt);\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.rule-number {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\twidth: 24px;\r\n\t\t\t\theight: 24px;\r\n\t\t\t\tborder-radius: 50%;\r\n\t\t\t\tbackground: var(--uui-color-default-emphasis);\r\n\t\t\t\tcolor: var(--uui-color-default-contrast);\r\n\t\t\t\tfont-size: 12px;\r\n\t\t\t\tfont-weight: 700;\r\n\t\t\t\tflex-shrink: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.role-name-input {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tpadding: var(--uui-size-space-1) var(--uui-size-space-2);\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tfont-size: var(--uui-type-default-size);\r\n\t\t\t\tfont-family: monospace;\r\n\t\t\t\tbackground: var(--uui-color-surface);\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\r\n\t\t\t.role-name-input:focus {\r\n\t\t\t\toutline: none;\r\n\t\t\t\tborder-color: var(--uui-color-focus);\r\n\t\t\t}\r\n\r\n\t\t\t/* Section headers within rule cards */\r\n\t\t\t.section-header {\r\n\t\t\t\tfont-size: 11px;\r\n\t\t\t\tfont-weight: 700;\r\n\t\t\t\ttext-transform: uppercase;\r\n\t\t\t\tletter-spacing: 0.5px;\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-1);\r\n\t\t\t}\r\n\r\n\t\t\t.section-header.collapsible {\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-1);\r\n\t\t\t\tuser-select: none;\r\n\t\t\t}\r\n\r\n\t\t\t.section-header.collapsible:hover {\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\r\n\t\t\t.section-header.collapsible uui-icon {\r\n\t\t\t\tfont-size: 10px;\r\n\t\t\t}\r\n\r\n\t\t\t/* Conditions */\r\n\t\t\t.conditions-area {\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t/* Exceptions */\r\n\t\t\t.exceptions-area {\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tborder-top: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.condition-row {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t.condition-type-select {\r\n\t\t\t\tmin-width: 180px;\r\n\t\t\t\tpadding: var(--uui-size-space-1) var(--uui-size-space-2);\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tbackground: var(--uui-color-surface);\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\r\n\t\t\t.condition-type-select:focus {\r\n\t\t\t\toutline: none;\r\n\t\t\t\tborder-color: var(--uui-color-focus);\r\n\t\t\t}\r\n\r\n\t\t\t.condition-value-input {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tpadding: var(--uui-size-space-1) var(--uui-size-space-2);\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tfont-family: monospace;\r\n\t\t\t\tbackground: var(--uui-color-surface);\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\r\n\t\t\t.condition-value-input:focus {\r\n\t\t\t\toutline: none;\r\n\t\t\t\tborder-color: var(--uui-color-focus);\r\n\t\t\t}\r\n\r\n\t\t\t/* Action area */\r\n\t\t\t.action-area {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t\tborder-top: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t/* Format area */\r\n\t\t\t.format-area {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t\tborder-top: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.action-select {\r\n\t\t\t\tpadding: var(--uui-size-space-1) var(--uui-size-space-2);\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tbackground: var(--uui-color-surface);\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\r\n\t\t\t.action-select:focus {\r\n\t\t\t\toutline: none;\r\n\t\t\t\tborder-color: var(--uui-color-focus);\r\n\t\t\t}\r\n\r\n\t\t\t/* Match preview */\r\n\t\t\t.match-preview {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tpadding: var(--uui-size-space-2) var(--uui-size-space-4);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tborder-top: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.match-preview.matched {\r\n\t\t\t\tbackground: color-mix(in srgb, var(--uui-color-positive) 10%, transparent);\r\n\t\t\t\tcolor: var(--uui-color-positive-standalone);\r\n\t\t\t}\r\n\r\n\t\t\t.match-preview.no-match {\r\n\t\t\t\tbackground: color-mix(in srgb, var(--uui-color-warning) 10%, transparent);\r\n\t\t\t\tcolor: var(--uui-color-warning-standalone);\r\n\t\t\t}\r\n\r\n\t\t\t.match-preview strong {\r\n\t\t\t\tfont-weight: 600;\r\n\t\t\t}\r\n\r\n\t\t\t/* Unmatched elements */\r\n\t\t\t.unmatched-section {\r\n\t\t\t\tborder: 1px dashed var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t.unmatched-section h4 {\r\n\t\t\t\tmargin: 0 0 var(--uui-size-space-3);\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\ttext-transform: uppercase;\r\n\t\t\t\tletter-spacing: 0.5px;\r\n\t\t\t}\r\n\r\n\t\t\t.unmatched-element {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t\tpadding: var(--uui-size-space-2) 0;\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.unmatched-element:last-child {\r\n\t\t\t\tborder-bottom: none;\r\n\t\t\t}\r\n\r\n\t\t\t.unmatched-text {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tmin-width: 0;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t}\r\n\r\n\t\t\t.unmatched-meta {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tgap: var(--uui-size-space-1);\r\n\t\t\t\tflex-shrink: 0;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UpDocSectionRulesEditorModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'up-doc-section-rules-editor-modal': UpDocSectionRulesEditorModalElement;\r\n\t}\r\n}\r\n"],"names":["normalizeAction","action","format","_UpDocSectionRulesEditorModalElement_instances","isCollapsed_fn","toggleCollapsed_fn","elements_get","sectionHeading_get","evaluateRules_fn","elementMatchesAllConditions_fn","elementMatchesCondition_fn","autoPopulateConditions_fn","addRule_fn","removeRule_fn","createRuleFromElement_fn","updateRoleName_fn","updateAction_fn","updateFormat_fn","addCondition_fn","removeCondition_fn","updateConditionType_fn","updateConditionValue_fn","addException_fn","removeException_fn","updateExceptionType_fn","updateExceptionValue_fn","onSubmit_fn","onClose_fn","renderConditionRow_fn","renderExceptionRow_fn","renderRuleCard_fn","truncate_fn","renderUnmatchedElements_fn","CONDITION_LABELS","VALUELESS_CONDITIONS","ALL_CONDITION_TYPES","ACTION_LABELS","ALL_ACTIONS","FORMAT_LABELS","ALL_FORMATS","UpDocSectionRulesEditorModalElement","UmbModalBaseElement","__privateAdd","cloned","rule","claimed","__privateMethod","ruleMatches","elId","ruleIdx","el","__privateGet","e","existing","html","idx","section","key","next","elements","elIdx","conditions","index","total","c","condition","val","numVal","elIndex","colonIdx","_","roleSuggestion","value","updated","condIdx","i","type","cond","isNumeric","excIdx","exc","isValueless","t","nothing","exception","matchedElements","cIdx","eIdx","a","f","text","max","unmatched","UmbTextStyles","css","__decorateClass","state","customElement","UpDocSectionRulesEditorModalElement_default"],"mappings":"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"}