{"version":3,"file":"destination-utils-CEQ5Lbpg.js","sources":["../src/destination-utils.ts"],"sourcesContent":["import type { DestinationConfig, MappingDestination } from './workflow.types.js';\r\n\r\nexport interface DestinationTab {\r\n\tid: string;\r\n\tlabel: string;\r\n}\r\n\r\n/**\r\n * Extracts the tab structure from a destination config.\r\n * Returns tabs in document order, with \"Page Content\" appended if blockGrids exist.\r\n */\r\nexport function getDestinationTabs(destination: DestinationConfig): DestinationTab[] {\r\n\tconst tabs: DestinationTab[] = [];\r\n\tconst tabNames = new Set(destination.fields.map((f) => f.tab).filter(Boolean));\r\n\r\n\tfor (const tabName of tabNames) {\r\n\t\ttabs.push({\r\n\t\t\tid: tabName!.toLowerCase().replace(/\\s+/g, '-'),\r\n\t\t\tlabel: tabName!,\r\n\t\t});\r\n\t}\r\n\r\n\tif (destination.blockGrids?.length) {\r\n\t\tif (!tabNames.has('Page Content')) {\r\n\t\t\ttabs.push({ id: 'page-content', label: 'Page Content' });\r\n\t\t}\r\n\t}\r\n\r\n\treturn tabs;\r\n}\r\n\r\n/**\r\n * Resolves which destination tab a mapping destination belongs to.\r\n * Block properties always resolve to 'page-content'.\r\n * Top-level fields resolve to their field's tab (kebab-case ID).\r\n * Returns null if the destination can't be matched.\r\n */\r\nexport function resolveDestinationTab(\r\n\tdest: MappingDestination,\r\n\tdestination: DestinationConfig,\r\n): string | null {\r\n\tif (dest.blockKey) {\r\n\t\treturn 'page-content';\r\n\t}\r\n\r\n\tconst field = destination.fields.find((f) => f.alias === dest.target);\r\n\tif (field?.tab) {\r\n\t\treturn field.tab.toLowerCase().replace(/\\s+/g, '-');\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n\r\n/**\r\n * Finds the block's display label given its key.\r\n * Used for sub-grouping block properties within the Page Content tab.\r\n */\r\nexport function resolveBlockLabel(\r\n\tblockKey: string,\r\n\tdestination: DestinationConfig,\r\n): string | null {\r\n\tfor (const grid of destination.blockGrids ?? []) {\r\n\t\tconst block = grid.blocks.find((b) => b.key === blockKey);\r\n\t\tif (block) return block.label;\r\n\t}\r\n\treturn null;\r\n}\r\n"],"names":["getDestinationTabs","destination","tabs","tabNames","f","tabName","resolveDestinationTab","dest","field","resolveBlockLabel","blockKey","grid","block","b"],"mappings":"AAWO,SAASA,EAAmBC,GAAkD;AACpF,QAAMC,IAAyB,CAAA,GACzBC,IAAW,IAAI,IAAIF,EAAY,OAAO,IAAI,CAACG,MAAMA,EAAE,GAAG,EAAE,OAAO,OAAO,CAAC;AAE7E,aAAWC,KAAWF;AACrB,IAAAD,EAAK,KAAK;AAAA,MACT,IAAIG,EAAS,YAAA,EAAc,QAAQ,QAAQ,GAAG;AAAA,MAC9C,OAAOA;AAAA,IAAA,CACP;AAGF,SAAIJ,EAAY,YAAY,WACtBE,EAAS,IAAI,cAAc,KAC/BD,EAAK,KAAK,EAAE,IAAI,gBAAgB,OAAO,gBAAgB,IAIlDA;AACR;AAQO,SAASI,EACfC,GACAN,GACgB;AAChB,MAAIM,EAAK;AACR,WAAO;AAGR,QAAMC,IAAQP,EAAY,OAAO,KAAK,CAACG,MAAMA,EAAE,UAAUG,EAAK,MAAM;AACpE,SAAIC,GAAO,MACHA,EAAM,IAAI,YAAA,EAAc,QAAQ,QAAQ,GAAG,IAG5C;AACR;AAMO,SAASC,EACfC,GACAT,GACgB;AAChB,aAAWU,KAAQV,EAAY,cAAc,CAAA,GAAI;AAChD,UAAMW,IAAQD,EAAK,OAAO,KAAK,CAACE,MAAMA,EAAE,QAAQH,CAAQ;AACxD,QAAIE,UAAcA,EAAM;AAAA,EACzB;AACA,SAAO;AACR;"}