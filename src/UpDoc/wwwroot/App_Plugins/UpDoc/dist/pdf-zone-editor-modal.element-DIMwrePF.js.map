{"version":3,"file":"pdf-zone-editor-modal.element-DIMwrePF.js","sources":["../src/pdf-zone-editor-modal.element.ts"],"sourcesContent":["import type { ZoneEditorModalData, ZoneEditorModalValue } from './pdf-zone-editor-modal.token.js';\r\nimport type { ZoneDefinition, ZoneTemplate } from './workflow.types.js';\r\nimport { fetchPdfBlob } from './workflow.service.js';\r\nimport { html, customElement, css, state, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport { UMB_AUTH_CONTEXT } from '@umbraco-cms/backoffice/auth';\r\nimport * as pdfjsLib from 'pdfjs-dist';\r\n\r\n// Configure PDF.js worker\r\npdfjsLib.GlobalWorkerOptions.workerSrc = '/App_Plugins/UpDoc/dist/pdf.worker.min.mjs';\r\n\r\n// Zone colors — cycling palette\r\nconst ZONE_COLORS = [\r\n\t'#e84855', '#f9dc5c', '#3185fc', '#5bba6f', '#e56399',\r\n\t'#8338ec', '#ff6d00', '#06d6a0', '#118ab2', '#ef476f',\r\n];\r\n\r\ninterface EditorZone {\r\n\tid: string;\r\n\tname: string;\r\n\tproperty: string;\r\n\tpage: number;\r\n\ttype: string;\r\n\tx: number;\r\n\ty: number;\r\n\tw: number;\r\n\th: number;\r\n\tcolor: string;\r\n\theadingFont: string;\r\n\texpectedSections: string[];\r\n\tnotes: string;\r\n}\r\n\r\ntype EditorMode = 'draw' | 'select';\r\n\r\n@customElement('pdf-zone-editor-modal')\r\nexport class PdfZoneEditorModalElement extends UmbModalBaseElement<\r\n\tZoneEditorModalData,\r\n\tZoneEditorModalValue\r\n> {\r\n\t// PDF state\r\n\t@state() private _pdfDoc: pdfjsLib.PDFDocumentProxy | null = null;\r\n\t@state() private _currentPage = 1;\r\n\t@state() private _totalPages = 0;\r\n\t@state() private _scale = 1.0;\r\n\t@state() private _loading = true;\r\n\t@state() private _error = '';\r\n\r\n\t// Zone state\r\n\t@state() private _zones: EditorZone[] = [];\r\n\t@state() private _selectedZoneId: string | null = null;\r\n\t@state() private _mode: EditorMode = 'draw';\r\n\t@state() private _pageWidth = 0;\r\n\t@state() private _pageHeight = 0;\r\n\r\n\t// Drawing state (not reactive — updated in mouse handlers)\r\n\tprivate _isDrawing = false;\r\n\tprivate _drawStart = { x: 0, y: 0 };\r\n\tprivate _drawCurrent = { x: 0, y: 0 };\r\n\r\n\t// Dragging/resizing state\r\n\tprivate _isDragging = false;\r\n\tprivate _isResizing = false;\r\n\tprivate _resizeHandle = '';\r\n\tprivate _dragStart = { x: 0, y: 0 };\r\n\tprivate _dragZoneStart = { x: 0, y: 0, w: 0, h: 0 };\r\n\r\n\t// Canvas refs\r\n\tprivate _canvas: HTMLCanvasElement | null = null;\r\n\tprivate _overlay: HTMLCanvasElement | null = null;\r\n\r\n\t// Next zone ID counter\r\n\tprivate _nextId = 1;\r\n\r\n\toverride async firstUpdated() {\r\n\t\tawait this.#loadPdf();\r\n\t}\r\n\r\n\tasync #getAuthToken(): Promise<string> {\r\n\t\tconst authContext = await this.getContext(UMB_AUTH_CONTEXT);\r\n\t\treturn authContext.getLatestToken();\r\n\t}\r\n\r\n\tasync #loadPdf() {\r\n\t\tconst workflowName = this.data?.workflowName;\r\n\t\tif (!workflowName) {\r\n\t\t\tthis._error = 'No workflow name provided.';\r\n\t\t\tthis._loading = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst token = await this.#getAuthToken();\r\n\t\t\tconst blob = await fetchPdfBlob(workflowName, token);\r\n\t\t\tif (!blob) {\r\n\t\t\t\tthis._error = 'Could not load PDF file.';\r\n\t\t\t\tthis._loading = false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst arrayBuffer = await blob.arrayBuffer();\r\n\t\t\tconst loadingTask = pdfjsLib.getDocument({ data: arrayBuffer });\r\n\t\t\tthis._pdfDoc = await loadingTask.promise;\r\n\t\t\tthis._totalPages = this._pdfDoc.numPages;\r\n\r\n\t\t\t// Load existing template zones if provided\r\n\t\t\tif (this.data?.existingTemplate?.zones?.length) {\r\n\t\t\t\tthis._zones = this.data.existingTemplate.zones.map((z, i) => ({\r\n\t\t\t\t\tid: `zone-${i + 1}`,\r\n\t\t\t\t\tname: z.name,\r\n\t\t\t\t\tproperty: z.property,\r\n\t\t\t\t\tpage: z.page,\r\n\t\t\t\t\ttype: z.type,\r\n\t\t\t\t\tx: z.bounds.x,\r\n\t\t\t\t\ty: z.bounds.y,\r\n\t\t\t\t\tw: z.bounds.width,\r\n\t\t\t\t\th: z.bounds.height,\r\n\t\t\t\t\tcolor: z.color || ZONE_COLORS[i % ZONE_COLORS.length],\r\n\t\t\t\t\theadingFont: z.headingFont,\r\n\t\t\t\t\texpectedSections: z.expectedSections,\r\n\t\t\t\t\tnotes: z.notes,\r\n\t\t\t\t}));\r\n\t\t\t\tthis._nextId = this._zones.length + 1;\r\n\t\t\t}\r\n\r\n\t\t\tthis._loading = false;\r\n\t\t\tawait this.updateComplete;\r\n\t\t\tawait this.#renderPage();\r\n\t\t} catch (e) {\r\n\t\t\tthis._error = `Failed to load PDF: ${e}`;\r\n\t\t\tthis._loading = false;\r\n\t\t}\r\n\t}\r\n\r\n\tasync #renderPage() {\r\n\t\tif (!this._pdfDoc) return;\r\n\r\n\t\tconst page = await this._pdfDoc.getPage(this._currentPage);\r\n\t\tconst viewport = page.getViewport({ scale: this._scale });\r\n\r\n\t\tthis._pageWidth = viewport.width;\r\n\t\tthis._pageHeight = viewport.height;\r\n\r\n\t\t// Get canvas elements from shadow DOM\r\n\t\tthis._canvas = this.renderRoot.querySelector('#pdf-canvas') as HTMLCanvasElement;\r\n\t\tthis._overlay = this.renderRoot.querySelector('#overlay-canvas') as HTMLCanvasElement;\r\n\r\n\t\tif (!this._canvas || !this._overlay) return;\r\n\r\n\t\tthis._canvas.width = viewport.width;\r\n\t\tthis._canvas.height = viewport.height;\r\n\t\tthis._overlay.width = viewport.width;\r\n\t\tthis._overlay.height = viewport.height;\r\n\r\n\t\tconst ctx = this._canvas.getContext('2d')!;\r\n\t\tawait page.render({ canvasContext: ctx, viewport }).promise;\r\n\r\n\t\tthis.#drawOverlay();\r\n\t}\r\n\r\n\t// =========================================================================\r\n\t// Coordinate conversion — PDF point space ↔ canvas pixel space\r\n\t// PDF: origin bottom-left, Y up. Canvas: origin top-left, Y down.\r\n\t// =========================================================================\r\n\r\n\t#pdfToCanvas(pdfX: number, pdfY: number): { cx: number; cy: number } {\r\n\t\tconst cx = pdfX * this._scale;\r\n\t\tconst cy = (this._pageHeight / this._scale - pdfY) * this._scale;\r\n\t\treturn { cx, cy };\r\n\t}\r\n\r\n\t#canvasToPdf(cx: number, cy: number): { px: number; py: number } {\r\n\t\tconst px = cx / this._scale;\r\n\t\tconst py = this._pageHeight / this._scale - cy / this._scale;\r\n\t\treturn { px, py };\r\n\t}\r\n\r\n\t// =========================================================================\r\n\t// Overlay drawing — zones rendered as colored rectangles\r\n\t// =========================================================================\r\n\r\n\t#drawOverlay() {\r\n\t\tif (!this._overlay) return;\r\n\t\tconst ctx = this._overlay.getContext('2d')!;\r\n\t\tctx.clearRect(0, 0, this._overlay.width, this._overlay.height);\r\n\r\n\t\t// Draw existing zones for current page\r\n\t\tfor (const zone of this._zones) {\r\n\t\t\tif (zone.page !== this._currentPage) continue;\r\n\r\n\t\t\tconst topLeft = this.#pdfToCanvas(zone.x, zone.y + zone.h);\r\n\t\t\tconst bottomRight = this.#pdfToCanvas(zone.x + zone.w, zone.y);\r\n\t\t\tconst w = bottomRight.cx - topLeft.cx;\r\n\t\t\tconst h = bottomRight.cy - topLeft.cy;\r\n\r\n\t\t\t// Fill\r\n\t\t\tctx.fillStyle = zone.color + '30'; // 30 = ~19% opacity\r\n\t\t\tctx.fillRect(topLeft.cx, topLeft.cy, w, h);\r\n\r\n\t\t\t// Border\r\n\t\t\tctx.strokeStyle = zone.color;\r\n\t\t\tctx.lineWidth = zone.id === this._selectedZoneId ? 3 : 2;\r\n\t\t\tctx.strokeRect(topLeft.cx, topLeft.cy, w, h);\r\n\r\n\t\t\t// Label\r\n\t\t\tctx.fillStyle = zone.color;\r\n\t\t\tctx.font = 'bold 12px sans-serif';\r\n\t\t\tctx.fillText(zone.name || 'Unnamed', topLeft.cx + 4, topLeft.cy + 14);\r\n\r\n\t\t\t// Resize handles for selected zone\r\n\t\t\tif (zone.id === this._selectedZoneId) {\r\n\t\t\t\tconst handleSize = 8;\r\n\t\t\t\tconst handles = [\r\n\t\t\t\t\t{ x: topLeft.cx, y: topLeft.cy }, // top-left\r\n\t\t\t\t\t{ x: topLeft.cx + w, y: topLeft.cy }, // top-right\r\n\t\t\t\t\t{ x: topLeft.cx, y: topLeft.cy + h }, // bottom-left\r\n\t\t\t\t\t{ x: topLeft.cx + w, y: topLeft.cy + h }, // bottom-right\r\n\t\t\t\t];\r\n\t\t\t\tctx.fillStyle = zone.color;\r\n\t\t\t\tfor (const h of handles) {\r\n\t\t\t\t\tctx.fillRect(h.x - handleSize / 2, h.y - handleSize / 2, handleSize, handleSize);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Draw active drawing rectangle\r\n\t\tif (this._isDrawing) {\r\n\t\t\tconst x = Math.min(this._drawStart.x, this._drawCurrent.x);\r\n\t\t\tconst y = Math.min(this._drawStart.y, this._drawCurrent.y);\r\n\t\t\tconst w = Math.abs(this._drawCurrent.x - this._drawStart.x);\r\n\t\t\tconst h = Math.abs(this._drawCurrent.y - this._drawStart.y);\r\n\r\n\t\t\tctx.strokeStyle = ZONE_COLORS[this._zones.length % ZONE_COLORS.length];\r\n\t\t\tctx.lineWidth = 2;\r\n\t\t\tctx.setLineDash([5, 5]);\r\n\t\t\tctx.strokeRect(x, y, w, h);\r\n\t\t\tctx.setLineDash([]);\r\n\t\t}\r\n\t}\r\n\r\n\t// =========================================================================\r\n\t// Mouse event handlers\r\n\t// =========================================================================\r\n\r\n\t#getCanvasPos(e: MouseEvent): { x: number; y: number } {\r\n\t\tif (!this._overlay) return { x: 0, y: 0 };\r\n\t\tconst rect = this._overlay.getBoundingClientRect();\r\n\t\treturn { x: e.clientX - rect.left, y: e.clientY - rect.top };\r\n\t}\r\n\r\n\t#findZoneAtPos(cx: number, cy: number): EditorZone | null {\r\n\t\tfor (const zone of this._zones) {\r\n\t\t\tif (zone.page !== this._currentPage) continue;\r\n\t\t\tconst topLeft = this.#pdfToCanvas(zone.x, zone.y + zone.h);\r\n\t\t\tconst bottomRight = this.#pdfToCanvas(zone.x + zone.w, zone.y);\r\n\t\t\tif (cx >= topLeft.cx && cx <= bottomRight.cx && cy >= topLeft.cy && cy <= bottomRight.cy) {\r\n\t\t\t\treturn zone;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t#findResizeHandle(zone: EditorZone, cx: number, cy: number): string {\r\n\t\tconst topLeft = this.#pdfToCanvas(zone.x, zone.y + zone.h);\r\n\t\tconst bottomRight = this.#pdfToCanvas(zone.x + zone.w, zone.y);\r\n\t\tconst threshold = 10;\r\n\r\n\t\tconst nearLeft = Math.abs(cx - topLeft.cx) < threshold;\r\n\t\tconst nearRight = Math.abs(cx - bottomRight.cx) < threshold;\r\n\t\tconst nearTop = Math.abs(cy - topLeft.cy) < threshold;\r\n\t\tconst nearBottom = Math.abs(cy - bottomRight.cy) < threshold;\r\n\r\n\t\tif (nearTop && nearLeft) return 'tl';\r\n\t\tif (nearTop && nearRight) return 'tr';\r\n\t\tif (nearBottom && nearLeft) return 'bl';\r\n\t\tif (nearBottom && nearRight) return 'br';\r\n\t\treturn '';\r\n\t}\r\n\r\n\t#onMouseDown(e: MouseEvent) {\r\n\t\tconst pos = this.#getCanvasPos(e);\r\n\r\n\t\tif (this._mode === 'draw') {\r\n\t\t\tthis._isDrawing = true;\r\n\t\t\tthis._drawStart = pos;\r\n\t\t\tthis._drawCurrent = pos;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Select mode\r\n\t\tconst zone = this.#findZoneAtPos(pos.x, pos.y);\r\n\t\tif (zone) {\r\n\t\t\tthis._selectedZoneId = zone.id;\r\n\t\t\tthis.#drawOverlay();\r\n\r\n\t\t\t// Check for resize handle\r\n\t\t\tconst handle = this.#findResizeHandle(zone, pos.x, pos.y);\r\n\t\t\tif (handle) {\r\n\t\t\t\tthis._isResizing = true;\r\n\t\t\t\tthis._resizeHandle = handle;\r\n\t\t\t\tthis._dragStart = pos;\r\n\t\t\t\tthis._dragZoneStart = { x: zone.x, y: zone.y, w: zone.w, h: zone.h };\r\n\t\t\t} else {\r\n\t\t\t\tthis._isDragging = true;\r\n\t\t\t\tthis._dragStart = pos;\r\n\t\t\t\tthis._dragZoneStart = { x: zone.x, y: zone.y, w: zone.w, h: zone.h };\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis._selectedZoneId = null;\r\n\t\t\tthis.#drawOverlay();\r\n\t\t}\r\n\t}\r\n\r\n\t#onMouseMove(e: MouseEvent) {\r\n\t\tconst pos = this.#getCanvasPos(e);\r\n\r\n\t\tif (this._isDrawing) {\r\n\t\t\tthis._drawCurrent = pos;\r\n\t\t\tthis.#drawOverlay();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._isDragging && this._selectedZoneId) {\r\n\t\t\tconst zone = this._zones.find(z => z.id === this._selectedZoneId);\r\n\t\t\tif (!zone) return;\r\n\r\n\t\t\tconst dx = (pos.x - this._dragStart.x) / this._scale;\r\n\t\t\tconst dy = -(pos.y - this._dragStart.y) / this._scale; // invert Y\r\n\r\n\t\t\tzone.x = this._dragZoneStart.x + dx;\r\n\t\t\tzone.y = this._dragZoneStart.y + dy;\r\n\t\t\tthis._zones = [...this._zones]; // trigger reactive update\r\n\t\t\tthis.#drawOverlay();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._isResizing && this._selectedZoneId) {\r\n\t\t\tconst zone = this._zones.find(z => z.id === this._selectedZoneId);\r\n\t\t\tif (!zone) return;\r\n\r\n\t\t\tconst dx = (pos.x - this._dragStart.x) / this._scale;\r\n\t\t\tconst dy = -(pos.y - this._dragStart.y) / this._scale;\r\n\t\t\tconst { x, y, w, h } = this._dragZoneStart;\r\n\r\n\t\t\tswitch (this._resizeHandle) {\r\n\t\t\t\tcase 'br':\r\n\t\t\t\t\tzone.w = Math.max(20, w + dx);\r\n\t\t\t\t\tzone.y = y + dy;\r\n\t\t\t\t\tzone.h = Math.max(20, h - dy);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'bl':\r\n\t\t\t\t\tzone.x = x + dx;\r\n\t\t\t\t\tzone.w = Math.max(20, w - dx);\r\n\t\t\t\t\tzone.y = y + dy;\r\n\t\t\t\t\tzone.h = Math.max(20, h - dy);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'tr':\r\n\t\t\t\t\tzone.w = Math.max(20, w + dx);\r\n\t\t\t\t\tzone.h = Math.max(20, h + dy);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'tl':\r\n\t\t\t\t\tzone.x = x + dx;\r\n\t\t\t\t\tzone.w = Math.max(20, w - dx);\r\n\t\t\t\t\tzone.h = Math.max(20, h + dy);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tthis._zones = [...this._zones];\r\n\t\t\tthis.#drawOverlay();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Update cursor\r\n\t\tif (this._mode === 'select' && this._overlay) {\r\n\t\t\tconst zone = this.#findZoneAtPos(pos.x, pos.y);\r\n\t\t\tif (zone && this._selectedZoneId === zone.id) {\r\n\t\t\t\tconst handle = this.#findResizeHandle(zone, pos.x, pos.y);\r\n\t\t\t\tif (handle === 'tl' || handle === 'br') {\r\n\t\t\t\t\tthis._overlay.style.cursor = 'nwse-resize';\r\n\t\t\t\t} else if (handle === 'tr' || handle === 'bl') {\r\n\t\t\t\t\tthis._overlay.style.cursor = 'nesw-resize';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._overlay.style.cursor = 'move';\r\n\t\t\t\t}\r\n\t\t\t} else if (zone) {\r\n\t\t\t\tthis._overlay.style.cursor = 'pointer';\r\n\t\t\t} else {\r\n\t\t\t\tthis._overlay.style.cursor = 'default';\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t#onMouseUp(e: MouseEvent) {\r\n\t\tif (this._isDrawing) {\r\n\t\t\tthis._isDrawing = false;\r\n\t\t\tconst pos = this.#getCanvasPos(e);\r\n\r\n\t\t\t// Minimum size check\r\n\t\t\tconst w = Math.abs(pos.x - this._drawStart.x);\r\n\t\t\tconst h = Math.abs(pos.y - this._drawStart.y);\r\n\t\t\tif (w > 10 && h > 10) {\r\n\t\t\t\t// Convert to PDF coords\r\n\t\t\t\tconst topLeft = this.#canvasToPdf(\r\n\t\t\t\t\tMath.min(this._drawStart.x, pos.x),\r\n\t\t\t\t\tMath.min(this._drawStart.y, pos.y)\r\n\t\t\t\t);\r\n\t\t\t\tconst bottomRight = this.#canvasToPdf(\r\n\t\t\t\t\tMath.max(this._drawStart.x, pos.x),\r\n\t\t\t\t\tMath.max(this._drawStart.y, pos.y)\r\n\t\t\t\t);\r\n\r\n\t\t\t\tconst newZone: EditorZone = {\r\n\t\t\t\t\tid: `zone-${this._nextId++}`,\r\n\t\t\t\t\tname: `Zone ${this._zones.filter(z => z.page === this._currentPage).length + 1}`,\r\n\t\t\t\t\tproperty: '',\r\n\t\t\t\t\tpage: this._currentPage,\r\n\t\t\t\t\ttype: '',\r\n\t\t\t\t\tx: topLeft.px,\r\n\t\t\t\t\ty: bottomRight.py,\r\n\t\t\t\t\tw: bottomRight.px - topLeft.px,\r\n\t\t\t\t\th: topLeft.py - bottomRight.py,\r\n\t\t\t\t\tcolor: ZONE_COLORS[(this._zones.length) % ZONE_COLORS.length],\r\n\t\t\t\t\theadingFont: '',\r\n\t\t\t\t\texpectedSections: [],\r\n\t\t\t\t\tnotes: '',\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis._zones = [...this._zones, newZone];\r\n\t\t\t\tthis._selectedZoneId = newZone.id;\r\n\t\t\t\tthis._mode = 'select';\r\n\t\t\t}\r\n\t\t\tthis.#drawOverlay();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._isDragging = false;\r\n\t\tthis._isResizing = false;\r\n\t}\r\n\r\n\t// =========================================================================\r\n\t// Page navigation\r\n\t// =========================================================================\r\n\r\n\tasync #goToPage(page: number) {\r\n\t\tif (page < 1 || page > this._totalPages) return;\r\n\t\tthis._currentPage = page;\r\n\t\tthis._selectedZoneId = null;\r\n\t\tawait this.updateComplete;\r\n\t\tawait this.#renderPage();\r\n\t}\r\n\r\n\t#onZoomIn() {\r\n\t\tthis._scale = Math.min(3.0, this._scale + 0.25);\r\n\t\tthis.#renderPage();\r\n\t}\r\n\r\n\t#onZoomOut() {\r\n\t\tthis._scale = Math.max(0.5, this._scale - 0.25);\r\n\t\tthis.#renderPage();\r\n\t}\r\n\r\n\t// =========================================================================\r\n\t// Zone management\r\n\t// =========================================================================\r\n\r\n\t#selectZone(id: string) {\r\n\t\tthis._selectedZoneId = id;\r\n\t\tthis._mode = 'select';\r\n\t\t// Navigate to the zone's page if different\r\n\t\tconst zone = this._zones.find(z => z.id === id);\r\n\t\tif (zone && zone.page !== this._currentPage) {\r\n\t\t\tthis.#goToPage(zone.page);\r\n\t\t} else {\r\n\t\t\tthis.#drawOverlay();\r\n\t\t}\r\n\t}\r\n\r\n\t#deleteZone(id: string) {\r\n\t\tthis._zones = this._zones.filter(z => z.id !== id);\r\n\t\tif (this._selectedZoneId === id) {\r\n\t\t\tthis._selectedZoneId = null;\r\n\t\t}\r\n\t\tthis.#drawOverlay();\r\n\t}\r\n\r\n\t#onZoneNameChange(id: string, name: string) {\r\n\t\tconst zone = this._zones.find(z => z.id === id);\r\n\t\tif (zone) {\r\n\t\t\tzone.name = name;\r\n\t\t\tthis._zones = [...this._zones];\r\n\t\t\tthis.#drawOverlay();\r\n\t\t}\r\n\t}\r\n\r\n\t// =========================================================================\r\n\t// Save / Cancel\r\n\t// =========================================================================\r\n\r\n\t#onSave() {\r\n\t\tconst template: ZoneTemplate = {\r\n\t\t\ttemplateName: this.data?.existingTemplate?.templateName || this.data?.workflowName || 'Zone Template',\r\n\t\t\tsourceFile: this.data?.existingTemplate?.sourceFile || '',\r\n\t\t\tpageSize: {\r\n\t\t\t\twidth: this._pageWidth / this._scale,\r\n\t\t\t\theight: this._pageHeight / this._scale,\r\n\t\t\t},\r\n\t\t\tcreatedAt: new Date().toISOString(),\r\n\t\t\tzones: this._zones.map(z => ({\r\n\t\t\t\tname: z.name,\r\n\t\t\t\tproperty: z.property,\r\n\t\t\t\tpage: z.page,\r\n\t\t\t\ttype: z.type,\r\n\t\t\t\tbounds: {\r\n\t\t\t\t\tx: Math.round(z.x * 10) / 10,\r\n\t\t\t\t\ty: Math.round(z.y * 10) / 10,\r\n\t\t\t\t\twidth: Math.round(z.w * 10) / 10,\r\n\t\t\t\t\theight: Math.round(z.h * 10) / 10,\r\n\t\t\t\t},\r\n\t\t\t\tcolor: z.color,\r\n\t\t\t\theadingFont: z.headingFont,\r\n\t\t\t\texpectedSections: z.expectedSections,\r\n\t\t\t\tnotes: z.notes,\r\n\t\t\t})),\r\n\t\t};\r\n\r\n\t\tthis.value = { template };\r\n\t\tthis._submitModal();\r\n\t}\r\n\r\n\t#onCancel() {\r\n\t\tthis._rejectModal();\r\n\t}\r\n\r\n\t// =========================================================================\r\n\t// Render\r\n\t// =========================================================================\r\n\r\n\tget #selectedZone(): EditorZone | null {\r\n\t\treturn this._zones.find(z => z.id === this._selectedZoneId) ?? null;\r\n\t}\r\n\r\n\tget #currentPageZones(): EditorZone[] {\r\n\t\treturn this._zones.filter(z => z.page === this._currentPage);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (this._loading) {\r\n\t\t\treturn html`\r\n\t\t\t\t<umb-body-layout headline=\"Define Areas\">\r\n\t\t\t\t\t<div class=\"loading\">\r\n\t\t\t\t\t\t<uui-loader></uui-loader>\r\n\t\t\t\t\t\t<span>Loading PDF...</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</umb-body-layout>\r\n\t\t\t`;\r\n\t\t}\r\n\r\n\t\tif (this._error) {\r\n\t\t\treturn html`\r\n\t\t\t\t<umb-body-layout headline=\"Define Areas\">\r\n\t\t\t\t\t<div class=\"error\">${this._error}</div>\r\n\t\t\t\t\t<uui-button slot=\"actions\" label=\"Close\" @click=${this.#onCancel}></uui-button>\r\n\t\t\t\t</umb-body-layout>\r\n\t\t\t`;\r\n\t\t}\r\n\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=\"Define Areas\">\r\n\t\t\t\t<div class=\"editor-layout\">\r\n\t\t\t\t\t<!-- Left: PDF + canvas -->\r\n\t\t\t\t\t<div class=\"pdf-panel\">\r\n\t\t\t\t\t\t<div class=\"toolbar\">\r\n\t\t\t\t\t\t\t<div class=\"toolbar-group\">\r\n\t\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\t\t\t\tlook=${this._mode === 'draw' ? 'primary' : 'secondary'}\r\n\t\t\t\t\t\t\t\t\tlabel=\"Draw\"\r\n\t\t\t\t\t\t\t\t\t@click=${() => { this._mode = 'draw'; }}>\r\n\t\t\t\t\t\t\t\t\tDraw\r\n\t\t\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\t\t\t\tlook=${this._mode === 'select' ? 'primary' : 'secondary'}\r\n\t\t\t\t\t\t\t\t\tlabel=\"Select\"\r\n\t\t\t\t\t\t\t\t\t@click=${() => { this._mode = 'select'; }}>\r\n\t\t\t\t\t\t\t\t\tSelect\r\n\t\t\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"toolbar-group\">\r\n\t\t\t\t\t\t\t\t<uui-button compact label=\"Previous page\" ?disabled=${this._currentPage <= 1}\r\n\t\t\t\t\t\t\t\t\t@click=${() => this.#goToPage(this._currentPage - 1)}>\r\n\t\t\t\t\t\t\t\t\t&laquo;\r\n\t\t\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t\t\t<span class=\"page-info\">Page ${this._currentPage} / ${this._totalPages}</span>\r\n\t\t\t\t\t\t\t\t<uui-button compact label=\"Next page\" ?disabled=${this._currentPage >= this._totalPages}\r\n\t\t\t\t\t\t\t\t\t@click=${() => this.#goToPage(this._currentPage + 1)}>\r\n\t\t\t\t\t\t\t\t\t&raquo;\r\n\t\t\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"toolbar-group\">\r\n\t\t\t\t\t\t\t\t<uui-button compact label=\"Zoom out\" @click=${this.#onZoomOut}>&minus;</uui-button>\r\n\t\t\t\t\t\t\t\t<span class=\"zoom-info\">${Math.round(this._scale * 100)}%</span>\r\n\t\t\t\t\t\t\t\t<uui-button compact label=\"Zoom in\" @click=${this.#onZoomIn}>+</uui-button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"canvas-container\">\r\n\t\t\t\t\t\t\t<canvas id=\"pdf-canvas\"></canvas>\r\n\t\t\t\t\t\t\t<canvas id=\"overlay-canvas\"\r\n\t\t\t\t\t\t\t\t@mousedown=${this.#onMouseDown}\r\n\t\t\t\t\t\t\t\t@mousemove=${this.#onMouseMove}\r\n\t\t\t\t\t\t\t\t@mouseup=${this.#onMouseUp}\r\n\t\t\t\t\t\t\t\tstyle=\"cursor: ${this._mode === 'draw' ? 'crosshair' : 'default'}\">\r\n\t\t\t\t\t\t\t</canvas>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<!-- Right: Zone list + edit -->\r\n\t\t\t\t\t<div class=\"zone-panel\">\r\n\t\t\t\t\t\t<uui-box headline=\"Zones on this page\">\r\n\t\t\t\t\t\t\t${this.#currentPageZones.length === 0\r\n\t\t\t\t\t\t\t\t? html`<p class=\"empty-hint\">Draw a zone on the PDF to get started.</p>`\r\n\t\t\t\t\t\t\t\t: this.#currentPageZones.map(zone => html`\r\n\t\t\t\t\t\t\t\t\t<div class=\"zone-item ${zone.id === this._selectedZoneId ? 'selected' : ''}\"\r\n\t\t\t\t\t\t\t\t\t\t@click=${() => this.#selectZone(zone.id)}>\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"zone-color\" style=\"background: ${zone.color}\"></span>\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"zone-name\">${zone.name || 'Unnamed'}</span>\r\n\t\t\t\t\t\t\t\t\t\t<uui-button compact look=\"secondary\" label=\"Delete\"\r\n\t\t\t\t\t\t\t\t\t\t\t@click=${(e: Event) => { e.stopPropagation(); this.#deleteZone(zone.id); }}>\r\n\t\t\t\t\t\t\t\t\t\t\t<uui-icon name=\"icon-trash\"></uui-icon>\r\n\t\t\t\t\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t`)}\r\n\t\t\t\t\t\t</uui-box>\r\n\r\n\t\t\t\t\t\t${this.#selectedZone ? html`\r\n\t\t\t\t\t\t\t<uui-box headline=\"Edit Zone\" style=\"margin-top: var(--uui-size-space-4)\">\r\n\t\t\t\t\t\t\t\t<div class=\"edit-form\">\r\n\t\t\t\t\t\t\t\t\t<label>Name</label>\r\n\t\t\t\t\t\t\t\t\t<uui-input\r\n\t\t\t\t\t\t\t\t\t\t.value=${this.#selectedZone.name}\r\n\t\t\t\t\t\t\t\t\t\t@change=${(e: Event) => {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.#onZoneNameChange(\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis._selectedZoneId!,\r\n\t\t\t\t\t\t\t\t\t\t\t\t(e.target as HTMLInputElement).value\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t</uui-input>\r\n\r\n\t\t\t\t\t\t\t\t\t<label>Color</label>\r\n\t\t\t\t\t\t\t\t\t<div class=\"color-swatches\">\r\n\t\t\t\t\t\t\t\t\t\t${ZONE_COLORS.map(c => html`\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"color-swatch ${c === this.#selectedZone!.color ? 'active' : ''}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"background: ${c}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t@click=${() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst zone = this._zones.find(z => z.id === this._selectedZoneId);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (zone) { zone.color = c; this._zones = [...this._zones]; this.#drawOverlay(); }\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t`)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</uui-box>\r\n\t\t\t\t\t\t` : nothing}\r\n\r\n\t\t\t\t\t\t${this._zones.length > 0 && this._zones.some(z => z.page !== this._currentPage) ? html`\r\n\t\t\t\t\t\t\t<uui-box headline=\"All zones\" style=\"margin-top: var(--uui-size-space-4)\">\r\n\t\t\t\t\t\t\t\t${this._zones.map(zone => html`\r\n\t\t\t\t\t\t\t\t\t<div class=\"zone-item ${zone.id === this._selectedZoneId ? 'selected' : ''}\"\r\n\t\t\t\t\t\t\t\t\t\t@click=${() => this.#selectZone(zone.id)}>\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"zone-color\" style=\"background: ${zone.color}\"></span>\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"zone-name\">${zone.name || 'Unnamed'}</span>\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"zone-page\">p${zone.page}</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t`)}\r\n\t\t\t\t\t\t\t</uui-box>\r\n\t\t\t\t\t\t` : nothing}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tslot=\"actions\"\r\n\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\tlabel=\"Save\"\r\n\t\t\t\t\t?disabled=${this._zones.length === 0}\r\n\t\t\t\t\t@click=${this.#onSave}>\r\n\t\t\t\t\tSave\r\n\t\t\t\t</uui-button>\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tslot=\"actions\"\r\n\t\t\t\t\tlabel=\"Cancel\"\r\n\t\t\t\t\t@click=${this.#onCancel}>\r\n\t\t\t\t\tCancel\r\n\t\t\t\t</uui-button>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t.loading {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-4);\r\n\t\t\t\tpadding: var(--uui-size-space-6);\r\n\t\t\t}\r\n\r\n\t\t\t.error {\r\n\t\t\t\tpadding: var(--uui-size-space-4);\r\n\t\t\t\tcolor: var(--uui-color-danger);\r\n\t\t\t}\r\n\r\n\t\t\t.editor-layout {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tgap: var(--uui-size-space-4);\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tmin-height: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.pdf-panel {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tmin-width: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.toolbar {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-4);\r\n\t\t\t\tpadding: var(--uui-size-space-2) var(--uui-size-space-3);\r\n\t\t\t\tbackground: var(--uui-color-surface-alt);\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-border);\r\n\t\t\t\tflex-shrink: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.toolbar-group {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t.page-info, .zoom-info {\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t}\r\n\r\n\t\t\t.canvas-container {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\toverflow: auto;\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tbackground: var(--uui-color-surface-alt);\r\n\t\t\t}\r\n\r\n\t\t\t.canvas-container canvas {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\r\n\t\t\t#overlay-canvas {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 0;\r\n\t\t\t\tleft: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.zone-panel {\r\n\t\t\t\twidth: 300px;\r\n\t\t\t\tflex-shrink: 0;\r\n\t\t\t\toverflow-y: auto;\r\n\t\t\t\tpadding-right: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t.zone-item {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tpadding: var(--uui-size-space-2) var(--uui-size-space-3);\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tborder: 1px solid transparent;\r\n\t\t\t}\r\n\r\n\t\t\t.zone-item:hover {\r\n\t\t\t\tbackground: var(--uui-color-surface-alt);\r\n\t\t\t}\r\n\r\n\t\t\t.zone-item.selected {\r\n\t\t\t\tbackground: var(--uui-color-selected);\r\n\t\t\t\tborder-color: var(--uui-color-selected-emphasis);\r\n\t\t\t}\r\n\r\n\t\t\t.zone-color {\r\n\t\t\t\twidth: 14px;\r\n\t\t\t\theight: 14px;\r\n\t\t\t\tborder-radius: 3px;\r\n\t\t\t\tflex-shrink: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.zone-name {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t}\r\n\r\n\t\t\t.zone-page {\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t}\r\n\r\n\t\t\t.empty-hint {\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tpadding: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t.edit-form {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t}\r\n\r\n\t\t\t.edit-form label {\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t}\r\n\r\n\t\t\t.color-swatches {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t.color-swatch {\r\n\t\t\t\twidth: 24px;\r\n\t\t\t\theight: 24px;\r\n\t\t\t\tborder-radius: 4px;\r\n\t\t\t\tborder: 2px solid transparent;\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\tpadding: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.color-swatch:hover {\r\n\t\t\t\topacity: 0.8;\r\n\t\t\t}\r\n\r\n\t\t\t.color-swatch.active {\r\n\t\t\t\tborder-color: var(--uui-color-text);\r\n\t\t\t\tbox-shadow: 0 0 0 2px var(--uui-color-surface);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default PdfZoneEditorModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'pdf-zone-editor-modal': PdfZoneEditorModalElement;\r\n\t}\r\n}\r\n"],"names":["_PdfZoneEditorModalElement_instances","getAuthToken_fn","loadPdf_fn","renderPage_fn","pdfToCanvas_fn","canvasToPdf_fn","drawOverlay_fn","getCanvasPos_fn","findZoneAtPos_fn","findResizeHandle_fn","onMouseDown_fn","onMouseMove_fn","onMouseUp_fn","goToPage_fn","onZoomIn_fn","onZoomOut_fn","selectZone_fn","deleteZone_fn","onZoneNameChange_fn","onSave_fn","onCancel_fn","selectedZone_get","currentPageZones_get","pdfjsLib.GlobalWorkerOptions","ZONE_COLORS","PdfZoneEditorModalElement","UmbModalBaseElement","__privateAdd","__privateMethod","html","__privateGet","zone","e","c","z","nothing","UMB_AUTH_CONTEXT","workflowName","token","blob","fetchPdfBlob","arrayBuffer","loadingTask","pdfjsLib.getDocument","i","page","viewport","ctx","pdfX","pdfY","cx","cy","px","py","topLeft","bottomRight","w","h","handles","x","y","rect","threshold","nearLeft","nearRight","nearTop","nearBottom","pos","handle","dx","dy","newZone","id","name","template","UmbTextStyles","css","__decorateClass","state","customElement","PdfZoneEditorModalElement_default"],"mappings":"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"}