{"version":3,"file":"destination-picker-modal.element-C_2Bsi2m.js","sources":["../src/destination-picker-modal.element.ts"],"sourcesContent":["import type { DestinationConfig, DestinationField, DestinationBlockGrid } from './workflow.types.js';\r\nimport type { DestinationPickerModalData, DestinationPickerModalValue } from './destination-picker-modal.token.js';\r\nimport { html, css, state, nothing, customElement } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\n\r\n@customElement('up-doc-destination-picker-modal')\r\nexport class UpDocDestinationPickerModalElement extends UmbModalBaseElement<\r\n\tDestinationPickerModalData,\r\n\tDestinationPickerModalValue\r\n> {\r\n\t@state() private _activeTab = '';\r\n\t@state() private _selectedTargets = new Map<string, { target: string; blockKey?: string }>();\r\n\r\n\toverride connectedCallback() {\r\n\t\tsuper.connectedCallback();\r\n\t\tconst tabs = this.#getTabs();\r\n\t\tif (tabs.length > 0) {\r\n\t\t\tthis._activeTab = tabs[0].id;\r\n\t\t}\r\n\t}\r\n\r\n\tget #destination(): DestinationConfig | undefined {\r\n\t\treturn this.data?.destination;\r\n\t}\r\n\r\n\t/** Build a Set of compound keys (blockKey:alias or alias) that are already mapped */\r\n\tget #alreadyMapped(): Set<string> {\r\n\t\tconst mapped = new Set<string>();\r\n\t\tfor (const mapping of this.data?.existingMappings ?? []) {\r\n\t\t\tif (mapping.enabled === false) continue;\r\n\t\t\tfor (const dest of mapping.destinations) {\r\n\t\t\t\tmapped.add(this.#makeKey(dest.target, dest.blockKey));\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn mapped;\r\n\t}\r\n\r\n\t#getTabs(): Array<{ id: string; label: string }> {\r\n\t\tif (!this.#destination) return [];\r\n\r\n\t\tconst tabs: Array<{ id: string; label: string }> = [];\r\n\t\tconst tabNames = new Set(this.#destination.fields.map((f) => f.tab).filter(Boolean));\r\n\r\n\t\tfor (const tabName of tabNames) {\r\n\t\t\ttabs.push({\r\n\t\t\t\tid: tabName!.toLowerCase().replace(/\\s+/g, '-'),\r\n\t\t\t\tlabel: tabName!,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (this.#destination.blockGrids?.length) {\r\n\t\t\tif (!tabNames.has('Page Content')) {\r\n\t\t\t\ttabs.push({ id: 'page-content', label: 'Page Content' });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn tabs;\r\n\t}\r\n\r\n\t#makeKey(alias: string, blockKey?: string): string {\r\n\t\treturn blockKey ? `${blockKey}:${alias}` : alias;\r\n\t}\r\n\r\n\t#toggleTarget(alias: string, blockKey?: string) {\r\n\t\tconst key = this.#makeKey(alias, blockKey);\r\n\t\tconst next = new Map(this._selectedTargets);\r\n\t\tif (next.has(key)) {\r\n\t\t\tnext.delete(key);\r\n\t\t} else {\r\n\t\t\tnext.set(key, { target: alias, blockKey });\r\n\t\t}\r\n\t\tthis._selectedTargets = next;\r\n\t}\r\n\r\n\t#onConfirm() {\r\n\t\tthis.value = { selectedTargets: Array.from(this._selectedTargets.values()) };\r\n\t\tthis.modalContext?.submit();\r\n\t}\r\n\r\n\t#onCancel() {\r\n\t\tthis.modalContext?.reject();\r\n\t}\r\n\r\n\t#renderField(field: DestinationField) {\r\n\t\tconst checked = this._selectedTargets.has(field.alias);\r\n\t\tconst mapped = this.#alreadyMapped.has(field.alias);\r\n\t\treturn html`\r\n\t\t\t<div class=\"field-item ${checked ? 'field-selected' : ''}\" @click=${() => this.#toggleTarget(field.alias)}>\r\n\t\t\t\t<uui-checkbox\r\n\t\t\t\t\tlabel=\"Select ${field.label}\"\r\n\t\t\t\t\t?checked=${checked}\r\n\t\t\t\t\t@click=${(e: Event) => e.stopPropagation()}\r\n\t\t\t\t\t@change=${() => this.#toggleTarget(field.alias)}>\r\n\t\t\t\t</uui-checkbox>\r\n\t\t\t\t<div class=\"field-info\">\r\n\t\t\t\t\t<span class=\"field-label\">${field.label}</span>\r\n\t\t\t\t\t${mapped ? html`<span class=\"field-mapped\">mapped</span>` : nothing}\r\n\t\t\t\t\t<span class=\"field-type\">${field.type}</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderFieldsForTab(tabName: string) {\r\n\t\tif (!this.#destination) return nothing;\r\n\r\n\t\tconst fields = this.#destination.fields.filter((f) => f.tab === tabName);\r\n\t\tif (fields.length === 0) return html`<p class=\"empty-message\">No fields in this tab.</p>`;\r\n\r\n\t\treturn html`\r\n\t\t\t<div class=\"field-list\">\r\n\t\t\t\t${fields.map((field) => this.#renderField(field))}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderBlockGrids() {\r\n\t\tif (!this.#destination?.blockGrids?.length) {\r\n\t\t\treturn html`<p class=\"empty-message\">No block grids configured.</p>`;\r\n\t\t}\r\n\r\n\t\treturn html`\r\n\t\t\t${this.#destination.blockGrids.map((grid) => this.#renderBlockGrid(grid))}\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderBlockGrid(grid: DestinationBlockGrid) {\r\n\t\treturn html`\r\n\t\t\t<div class=\"block-grid\">\r\n\t\t\t\t<div class=\"block-grid-header\">\r\n\t\t\t\t\t<span class=\"block-grid-label\">${grid.label}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"block-list\">\r\n\t\t\t\t\t${grid.blocks.map(\r\n\t\t\t\t\t\t(block) => html`\r\n\t\t\t\t\t\t\t<div class=\"block-item\">\r\n\t\t\t\t\t\t\t\t<div class=\"block-header\">\r\n\t\t\t\t\t\t\t\t\t<umb-icon name=\"icon-box\"></umb-icon>\r\n\t\t\t\t\t\t\t\t\t<span class=\"block-label\">${block.label}</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t${block.properties?.length\r\n\t\t\t\t\t\t\t\t\t? html`\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"block-properties\">\r\n\t\t\t\t\t\t\t\t\t\t\t${block.properties.map((prop) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst compoundKey = this.#makeKey(prop.alias, block.key);\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst checked = this._selectedTargets.has(compoundKey);\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst mapped = this.#alreadyMapped.has(compoundKey);\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn html`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"block-property ${checked ? 'field-selected' : ''}\" @click=${() => this.#toggleTarget(prop.alias, block.key)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<uui-checkbox\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Select ${prop.label || prop.alias}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t?checked=${checked}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@click=${(e: Event) => e.stopPropagation()}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t@change=${() => this.#toggleTarget(prop.alias, block.key)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</uui-checkbox>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"block-property-label\">${prop.label || prop.alias}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t${mapped ? html`<span class=\"field-mapped\">mapped</span>` : nothing}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"field-type\">${prop.type}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t`;\r\n\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t`\r\n\t\t\t\t\t\t\t\t\t: nothing}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t`\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderTabContent() {\r\n\t\tif (!this.#destination) return nothing;\r\n\r\n\t\tif (this._activeTab === 'page-content') {\r\n\t\t\treturn this.#renderBlockGrids();\r\n\t\t}\r\n\r\n\t\tconst tabName = this.#destination.fields.find(\r\n\t\t\t(f) => f.tab && f.tab.toLowerCase().replace(/\\s+/g, '-') === this._activeTab\r\n\t\t)?.tab;\r\n\r\n\t\tif (tabName) {\r\n\t\t\treturn this.#renderFieldsForTab(tabName);\r\n\t\t}\r\n\r\n\t\treturn nothing;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tconst tabs = this.#getTabs();\r\n\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=\"Pick destination field(s)\">\r\n\t\t\t\t<div class=\"tab-content\">\r\n\t\t\t\t\t<uui-tab-group class=\"content-inner-tabs\" dropdown-content-direction=\"vertical\">\r\n\t\t\t\t\t\t${tabs.map(\r\n\t\t\t\t\t\t\t(tab) => html`\r\n\t\t\t\t\t\t\t\t<uui-tab\r\n\t\t\t\t\t\t\t\t\tlabel=${tab.label}\r\n\t\t\t\t\t\t\t\t\t?active=${this._activeTab === tab.id}\r\n\t\t\t\t\t\t\t\t\t@click=${() => { this._activeTab = tab.id; }}>\r\n\t\t\t\t\t\t\t\t\t${tab.label}\r\n\t\t\t\t\t\t\t\t</uui-tab>\r\n\t\t\t\t\t\t\t`\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</uui-tab-group>\r\n\r\n\t\t\t\t\t${this.#renderTabContent()}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div slot=\"actions\">\r\n\t\t\t\t\t<uui-button label=\"Cancel\" @click=${this.#onCancel}>Cancel</uui-button>\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\tlabel=\"Confirm\"\r\n\t\t\t\t\t\t?disabled=${this._selectedTargets.size === 0}\r\n\t\t\t\t\t\t@click=${this.#onConfirm}>\r\n\t\t\t\t\t\tMap to ${this._selectedTargets.size} field${this._selectedTargets.size !== 1 ? 's' : ''}\r\n\t\t\t\t\t</uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\t--uui-tab-background: var(--uui-color-surface);\r\n\t\t\t}\r\n\r\n\t\t\t.tab-content {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\r\n\t\t\t/* Inner tabs â€” bleed edge-to-edge past body layout padding */\r\n\t\t\t.content-inner-tabs {\r\n\t\t\t\tmargin: calc(var(--uui-size-layout-1) * -1);\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-4);\r\n\t\t\t\tbackground: var(--uui-color-surface);\r\n\t\t\t\t--uui-tab-background: var(--uui-color-surface);\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.empty-message {\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t\tfont-style: italic;\r\n\t\t\t\tpadding: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t.field-list {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\r\n\t\t\t.field-item {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-border);\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t}\r\n\r\n\t\t\t.field-item:hover {\r\n\t\t\t\tbackground: var(--uui-color-surface-emphasis);\r\n\t\t\t}\r\n\r\n\t\t\t.field-item.field-selected {\r\n\t\t\t\tbackground: var(--uui-color-selected);\r\n\t\t\t}\r\n\r\n\t\t\t.field-item:last-child {\r\n\t\t\t\tborder-bottom: none;\r\n\t\t\t}\r\n\r\n\t\t\t.field-info {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t\tflex: 1;\r\n\t\t\t}\r\n\r\n\t\t\t.field-label {\r\n\t\t\t\tfont-weight: 600;\r\n\t\t\t}\r\n\r\n\t\t\t.field-type {\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t\tbackground: var(--uui-color-surface-alt);\r\n\t\t\t\tpadding: 2px 8px;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t}\r\n\r\n\t\t\t.field-mapped {\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tcolor: var(--uui-color-positive-standalone);\r\n\t\t\t\tbackground: var(--uui-color-positive-emphasis);\r\n\t\t\t\tpadding: 2px 8px;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t}\r\n\r\n\t\t\t.block-grid {\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-3);\r\n\t\t\t}\r\n\r\n\t\t\t.block-grid-header {\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t\tbackground: var(--uui-color-surface-alt);\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.block-grid-label {\r\n\t\t\t\tfont-weight: 600;\r\n\t\t\t}\r\n\r\n\t\t\t.block-list {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\r\n\t\t\t.block-item {\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t\tpadding-left: var(--uui-size-space-6);\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.block-item:last-child {\r\n\t\t\t\tborder-bottom: none;\r\n\t\t\t}\r\n\r\n\t\t\t.block-header {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t.block-label {\r\n\t\t\t\tfont-weight: 600;\r\n\t\t\t}\r\n\r\n\t\t\t.block-properties {\r\n\t\t\t\tpadding-left: var(--uui-size-space-5);\r\n\t\t\t}\r\n\r\n\t\t\t.block-property {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tpadding: var(--uui-size-space-2) var(--uui-size-space-3);\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t}\r\n\r\n\t\t\t.block-property:hover {\r\n\t\t\t\tbackground: var(--uui-color-surface-emphasis);\r\n\t\t\t}\r\n\r\n\t\t\t.block-property.field-selected {\r\n\t\t\t\tbackground: var(--uui-color-selected);\r\n\t\t\t}\r\n\r\n\t\t\t.block-property-label {\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UpDocDestinationPickerModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'up-doc-destination-picker-modal': UpDocDestinationPickerModalElement;\r\n\t}\r\n}\r\n"],"names":["_UpDocDestinationPickerModalElement_instances","destination_get","alreadyMapped_get","getTabs_fn","makeKey_fn","toggleTarget_fn","onConfirm_fn","onCancel_fn","renderField_fn","renderFieldsForTab_fn","renderBlockGrids_fn","renderBlockGrid_fn","renderTabContent_fn","UpDocDestinationPickerModalElement","UmbModalBaseElement","__privateAdd","tabs","__privateMethod","html","tab","mapped","mapping","dest","__privateGet","tabNames","f","tabName","alias","blockKey","key","next","field","checked","e","nothing","fields","grid","block","prop","compoundKey","UmbTextStyles","css","__decorateClass","state","customElement","UpDocDestinationPickerModalElement_default"],"mappings":"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"}