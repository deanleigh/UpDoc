{"version":3,"file":"section-rules-editor-modal.element-DjResBSt.js","sources":["../src/section-rules-editor-modal.element.ts"],"sourcesContent":["import type { SectionRulesEditorModalData, SectionRulesEditorModalValue } from './section-rules-editor-modal.token.js';\r\nimport type { SectionRule, RuleCondition, RuleConditionType, RuleAction, AreaElement } from './workflow.types.js';\r\nimport { html, css, state, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport { customElement } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\n\r\n/** Friendly labels for condition types */\r\nconst CONDITION_LABELS: Record<RuleConditionType, string> = {\r\n\ttextBeginsWith: 'Text begins with',\r\n\ttextEndsWith: 'Text ends with',\r\n\ttextContains: 'Text contains',\r\n\ttextEquals: 'Text equals',\r\n\ttextMatchesPattern: 'Text matches pattern',\r\n\tfontSizeEquals: 'Font size equals',\r\n\tfontSizeAbove: 'Font size above',\r\n\tfontSizeBelow: 'Font size below',\r\n\tfontNameContains: 'Font name contains',\r\n\tfontNameEquals: 'Font name equals',\r\n\tcolorEquals: 'Color equals',\r\n\tpositionFirst: 'Position: first',\r\n\tpositionLast: 'Position: last',\r\n};\r\n\r\n/** Condition types that don't need a value input */\r\nconst VALUELESS_CONDITIONS: RuleConditionType[] = ['positionFirst', 'positionLast'];\r\n\r\n/** All available condition types */\r\nconst ALL_CONDITION_TYPES: RuleConditionType[] = [\r\n\t'textBeginsWith', 'textEndsWith', 'textContains', 'textEquals', 'textMatchesPattern',\r\n\t'fontSizeEquals', 'fontSizeAbove', 'fontSizeBelow',\r\n\t'fontNameContains', 'fontNameEquals', 'colorEquals',\r\n\t'positionFirst', 'positionLast',\r\n];\r\n\r\n/** Friendly labels for rule actions */\r\nconst ACTION_LABELS: Record<RuleAction, string> = {\r\n\tcreateSection: 'Create section',\r\n\tsetAsHeading: 'Set as heading',\r\n\taddAsContent: 'Add as content',\r\n\taddAsList: 'Add as list item',\r\n\texclude: 'Exclude',\r\n};\r\n\r\n/** All available rule actions */\r\nconst ALL_ACTIONS: RuleAction[] = ['createSection', 'setAsHeading', 'addAsContent', 'addAsList', 'exclude'];\r\n\r\n@customElement('up-doc-section-rules-editor-modal')\r\nexport class UpDocSectionRulesEditorModalElement extends UmbModalBaseElement<SectionRulesEditorModalData, SectionRulesEditorModalValue> {\r\n\t@state() private _rules: SectionRule[] = [];\r\n\r\n\toverride firstUpdated() {\r\n\t\t// Deep clone existing rules so edits don't mutate the original\r\n\t\tif (this.data?.existingRules?.rules?.length) {\r\n\t\t\tthis._rules = JSON.parse(JSON.stringify(this.data.existingRules.rules));\r\n\t\t}\r\n\t}\r\n\r\n\tget #elements(): AreaElement[] {\r\n\t\treturn this.data?.elements ?? [];\r\n\t}\r\n\r\n\tget #sectionHeading(): string {\r\n\t\treturn this.data?.sectionHeading ?? 'Section';\r\n\t}\r\n\r\n\t// ===== Rule evaluation (first-match-wins) =====\r\n\r\n\t/** Evaluate all rules against elements. Returns a map of elementId -> ruleIndex */\r\n\t#evaluateRules(): Map<string, number> {\r\n\t\tconst claimed = new Map<string, number>();\r\n\t\tconst elements = this.#elements;\r\n\r\n\t\tfor (let ruleIdx = 0; ruleIdx < this._rules.length; ruleIdx++) {\r\n\t\t\tconst rule = this._rules[ruleIdx];\r\n\t\t\tif (rule.conditions.length === 0) continue;\r\n\r\n\t\t\tfor (let elIdx = 0; elIdx < elements.length; elIdx++) {\r\n\t\t\t\tconst el = elements[elIdx];\r\n\t\t\t\tif (claimed.has(el.id)) continue; // already claimed by an earlier rule\r\n\r\n\t\t\t\tif (this.#elementMatchesAllConditions(el, rule.conditions, elIdx, elements.length)) {\r\n\t\t\t\t\tclaimed.set(el.id, ruleIdx);\r\n\t\t\t\t\t// No break — a rule can match multiple elements (e.g. repeating section headings)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn claimed;\r\n\t}\r\n\r\n\t#elementMatchesAllConditions(el: AreaElement, conditions: RuleCondition[], index: number, total: number): boolean {\r\n\t\treturn conditions.every((c) => this.#elementMatchesCondition(el, c, index, total));\r\n\t}\r\n\r\n\t#elementMatchesCondition(el: AreaElement, condition: RuleCondition, index: number, total: number): boolean {\r\n\t\tconst val = String(condition.value ?? '');\r\n\t\tconst numVal = Number(condition.value);\r\n\r\n\t\tswitch (condition.type) {\r\n\t\t\tcase 'textBeginsWith':\r\n\t\t\t\treturn el.text.toLowerCase().startsWith(val.toLowerCase());\r\n\t\t\tcase 'textEndsWith':\r\n\t\t\t\treturn el.text.toLowerCase().endsWith(val.toLowerCase());\r\n\t\t\tcase 'textContains':\r\n\t\t\t\treturn el.text.toLowerCase().includes(val.toLowerCase());\r\n\t\t\tcase 'textMatchesPattern':\r\n\t\t\t\ttry { return new RegExp(val, 'i').test(el.text); } catch { return false; }\r\n\t\t\tcase 'fontSizeEquals':\r\n\t\t\t\treturn !isNaN(numVal) && Math.abs(el.fontSize - numVal) < 0.5;\r\n\t\t\tcase 'fontSizeAbove':\r\n\t\t\t\treturn !isNaN(numVal) && el.fontSize > numVal;\r\n\t\t\tcase 'fontSizeBelow':\r\n\t\t\t\treturn !isNaN(numVal) && el.fontSize < numVal;\r\n\t\t\tcase 'fontNameContains':\r\n\t\t\t\treturn el.fontName.toLowerCase().includes(val.toLowerCase());\r\n\t\t\tcase 'colorEquals':\r\n\t\t\t\treturn el.color.toLowerCase() === val.toLowerCase();\r\n\t\t\tcase 'positionFirst':\r\n\t\t\t\treturn index === 0;\r\n\t\t\tcase 'positionLast':\r\n\t\t\t\treturn index === total - 1;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t// ===== Auto-populate conditions from an element =====\r\n\r\n\t#autoPopulateConditions(el: AreaElement, elIndex: number, total: number): RuleCondition[] {\r\n\t\tconst conditions: RuleCondition[] = [];\r\n\r\n\t\t// Font size\r\n\t\tconditions.push({ type: 'fontSizeEquals', value: el.fontSize });\r\n\r\n\t\t// Font name\r\n\t\tif (el.fontName) {\r\n\t\t\tconditions.push({ type: 'fontNameContains', value: el.fontName });\r\n\t\t}\r\n\r\n\t\t// Color (skip black/very dark as it's the default)\r\n\t\tif (el.color && el.color.toLowerCase() !== '#000000' && el.color.toLowerCase() !== '#000') {\r\n\t\t\tconditions.push({ type: 'colorEquals', value: el.color });\r\n\t\t}\r\n\r\n\t\t// Text prefix — if text contains a colon, use \"begins with\" up to the colon\r\n\t\tconst colonIdx = el.text.indexOf(':');\r\n\t\tif (colonIdx > 0 && colonIdx < 30) {\r\n\t\t\tconditions.push({ type: 'textBeginsWith', value: el.text.substring(0, colonIdx + 1) });\r\n\t\t}\r\n\r\n\t\t// Position\r\n\t\tif (elIndex === 0) {\r\n\t\t\tconditions.push({ type: 'positionFirst' });\r\n\t\t} else if (elIndex === total - 1) {\r\n\t\t\tconditions.push({ type: 'positionLast' });\r\n\t\t}\r\n\r\n\t\treturn conditions;\r\n\t}\r\n\r\n\t// ===== Rule CRUD =====\r\n\r\n\t#addRule() {\r\n\t\tthis._rules = [...this._rules, { role: '', action: 'createSection' as RuleAction, conditions: [] }];\r\n\t}\r\n\r\n\t#removeRule(ruleIdx: number) {\r\n\t\tthis._rules = this._rules.filter((_, i) => i !== ruleIdx);\r\n\t}\r\n\r\n\t#createRuleFromElement(el: AreaElement, elIndex: number) {\r\n\t\tconst conditions = this.#autoPopulateConditions(el, elIndex, this.#elements.length);\r\n\t\t// Derive a role name suggestion from text (kebab-case first few words)\r\n\t\tconst roleSuggestion = el.text\r\n\t\t\t.split(/[\\s:,]+/)\r\n\t\t\t.slice(0, 3)\r\n\t\t\t.join('-')\r\n\t\t\t.toLowerCase()\r\n\t\t\t.replace(/[^a-z0-9-]/g, '');\r\n\t\tthis._rules = [...this._rules, { role: roleSuggestion, action: 'createSection' as RuleAction, conditions }];\r\n\t}\r\n\r\n\t#updateRoleName(ruleIdx: number, value: string) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tupdated[ruleIdx] = { ...updated[ruleIdx], role: value };\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#updateAction(ruleIdx: number, value: RuleAction) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tupdated[ruleIdx] = { ...updated[ruleIdx], action: value };\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#addCondition(ruleIdx: number) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.conditions = [...rule.conditions, { type: 'textBeginsWith', value: '' }];\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#removeCondition(ruleIdx: number, condIdx: number) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.conditions = rule.conditions.filter((_, i) => i !== condIdx);\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#updateConditionType(ruleIdx: number, condIdx: number, type: RuleConditionType) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.conditions = [...rule.conditions];\r\n\t\trule.conditions[condIdx] = {\r\n\t\t\ttype,\r\n\t\t\tvalue: VALUELESS_CONDITIONS.includes(type) ? undefined : rule.conditions[condIdx].value,\r\n\t\t};\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t#updateConditionValue(ruleIdx: number, condIdx: number, value: string) {\r\n\t\tconst updated = [...this._rules];\r\n\t\tconst rule = { ...updated[ruleIdx] };\r\n\t\trule.conditions = [...rule.conditions];\r\n\t\tconst cond = rule.conditions[condIdx];\r\n\t\t// Store as number for font size conditions\r\n\t\tconst isNumeric = cond.type === 'fontSizeEquals' || cond.type === 'fontSizeAbove' || cond.type === 'fontSizeBelow';\r\n\t\trule.conditions[condIdx] = { ...cond, value: isNumeric && !isNaN(Number(value)) ? Number(value) : value };\r\n\t\tupdated[ruleIdx] = rule;\r\n\t\tthis._rules = updated;\r\n\t}\r\n\r\n\t// ===== Submit =====\r\n\r\n\t#onSubmit() {\r\n\t\tthis.value = { rules: { rules: this._rules } };\r\n\t\tthis.modalContext?.submit();\r\n\t}\r\n\r\n\t#onClose() {\r\n\t\tthis.modalContext?.reject();\r\n\t}\r\n\r\n\t// ===== Rendering =====\r\n\r\n\t#renderConditionRow(ruleIdx: number, condIdx: number, condition: RuleCondition) {\r\n\t\tconst isValueless = VALUELESS_CONDITIONS.includes(condition.type);\r\n\t\treturn html`\r\n\t\t\t<div class=\"condition-row\">\r\n\t\t\t\t<select\r\n\t\t\t\t\tclass=\"condition-type-select\"\r\n\t\t\t\t\t.value=${condition.type}\r\n\t\t\t\t\t@change=${(e: Event) => this.#updateConditionType(ruleIdx, condIdx, (e.target as HTMLSelectElement).value as RuleConditionType)}>\r\n\t\t\t\t\t${ALL_CONDITION_TYPES.map((t) => html`\r\n\t\t\t\t\t\t<option value=${t} ?selected=${t === condition.type}>${CONDITION_LABELS[t]}</option>\r\n\t\t\t\t\t`)}\r\n\t\t\t\t</select>\r\n\t\t\t\t${isValueless ? nothing : html`\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tclass=\"condition-value-input\"\r\n\t\t\t\t\t\tplaceholder=\"Value...\"\r\n\t\t\t\t\t\t.value=${String(condition.value ?? '')}\r\n\t\t\t\t\t\t@input=${(e: Event) => this.#updateConditionValue(ruleIdx, condIdx, (e.target as HTMLInputElement).value)} />\r\n\t\t\t\t`}\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tcompact\r\n\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\tlabel=\"Remove condition\"\r\n\t\t\t\t\t@click=${() => this.#removeCondition(ruleIdx, condIdx)}>\r\n\t\t\t\t\t<uui-icon name=\"icon-trash\"></uui-icon>\r\n\t\t\t\t</uui-button>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderRuleCard(rule: SectionRule, ruleIdx: number, matchedElements: AreaElement[]) {\r\n\t\treturn html`\r\n\t\t\t<div class=\"rule-card\">\r\n\t\t\t\t<div class=\"rule-header\">\r\n\t\t\t\t\t<span class=\"rule-number\">${ruleIdx + 1}</span>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tclass=\"role-name-input\"\r\n\t\t\t\t\t\tplaceholder=\"Section name (e.g. tour-title)\"\r\n\t\t\t\t\t\t.value=${rule.role}\r\n\t\t\t\t\t\t@input=${(e: Event) => this.#updateRoleName(ruleIdx, (e.target as HTMLInputElement).value)} />\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\t\tcolor=\"danger\"\r\n\t\t\t\t\t\tlabel=\"Remove rule\"\r\n\t\t\t\t\t\t@click=${() => this.#removeRule(ruleIdx)}>\r\n\t\t\t\t\t\t<uui-icon name=\"icon-trash\"></uui-icon>\r\n\t\t\t\t\t</uui-button>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"conditions-area\">\r\n\t\t\t\t\t${rule.conditions.map((cond, cIdx) => this.#renderConditionRow(ruleIdx, cIdx, cond))}\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\t\t\tlabel=\"Add condition\"\r\n\t\t\t\t\t\t@click=${() => this.#addCondition(ruleIdx)}>\r\n\t\t\t\t\t\t+ Add condition\r\n\t\t\t\t\t</uui-button>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"action-area\">\r\n\t\t\t\t\t<label class=\"action-label\">Action:</label>\r\n\t\t\t\t\t<select\r\n\t\t\t\t\t\tclass=\"action-select\"\r\n\t\t\t\t\t\t.value=${rule.action ?? 'createSection'}\r\n\t\t\t\t\t\t@change=${(e: Event) => this.#updateAction(ruleIdx, (e.target as HTMLSelectElement).value as RuleAction)}>\r\n\t\t\t\t\t\t${ALL_ACTIONS.map((a) => html`\r\n\t\t\t\t\t\t\t<option value=${a} ?selected=${a === (rule.action ?? 'createSection')}>${ACTION_LABELS[a]}</option>\r\n\t\t\t\t\t\t`)}\r\n\t\t\t\t\t</select>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"match-preview ${matchedElements.length > 0 ? 'matched' : 'no-match'}\">\r\n\t\t\t\t\t${matchedElements.length > 0\r\n\t\t\t\t\t\t? html`<uui-icon name=\"icon-check\"></uui-icon> Matched <strong>${matchedElements.length}&times;</strong>${matchedElements.length <= 5 ? html`: ${matchedElements.map((el, i) => html`${i > 0 ? html`, ` : nothing}<strong>${this.#truncate(el.text, 40)}</strong>`)}` : nothing}`\r\n\t\t\t\t\t\t: html`<uui-icon name=\"icon-alert\"></uui-icon> ${rule.conditions.length === 0 ? 'Add conditions to match elements' : 'No match'}`}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#truncate(text: string, max: number): string {\r\n\t\treturn text.length > max ? text.substring(0, max) + '...' : text;\r\n\t}\r\n\r\n\t#renderUnmatchedElements(claimed: Map<string, number>) {\r\n\t\tconst elements = this.#elements;\r\n\t\tconst unmatched = elements.filter((el) => !claimed.has(el.id));\r\n\t\tif (unmatched.length === 0) return nothing;\r\n\r\n\t\treturn html`\r\n\t\t\t<div class=\"unmatched-section\">\r\n\t\t\t\t<h4>Unmatched elements (${unmatched.length})</h4>\r\n\t\t\t\t${unmatched.map((el) => {\r\n\t\t\t\t\tconst elIndex = elements.indexOf(el);\r\n\t\t\t\t\treturn html`\r\n\t\t\t\t\t\t<div class=\"unmatched-element\">\r\n\t\t\t\t\t\t\t<div class=\"unmatched-text\">${this.#truncate(el.text, 80)}</div>\r\n\t\t\t\t\t\t\t<div class=\"unmatched-meta\">\r\n\t\t\t\t\t\t\t\t<span class=\"meta-badge\">${el.fontSize}pt</span>\r\n\t\t\t\t\t\t\t\t<span class=\"meta-badge\">${el.fontName}</span>\r\n\t\t\t\t\t\t\t\t${el.color !== '#000000' ? html`<span class=\"meta-badge\" style=\"border-left: 3px solid ${el.color};\">${el.color}</span>` : nothing}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\t\t\tlook=\"outline\"\r\n\t\t\t\t\t\t\t\tlabel=\"Create rule from this\"\r\n\t\t\t\t\t\t\t\t@click=${() => this.#createRuleFromElement(el, elIndex)}>\r\n\t\t\t\t\t\t\t\tCreate rule\r\n\t\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t`;\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tconst claimed = this.#evaluateRules();\r\n\r\n\t\t// Build ruleIdx -> all matched elements lookup\r\n\t\tconst ruleMatches = new Map<number, AreaElement[]>();\r\n\t\tfor (const [elId, ruleIdx] of claimed) {\r\n\t\t\tconst el = this.#elements.find((e) => e.id === elId);\r\n\t\t\tif (el) {\r\n\t\t\t\tconst existing = ruleMatches.get(ruleIdx) ?? [];\r\n\t\t\t\texisting.push(el);\r\n\t\t\t\truleMatches.set(ruleIdx, existing);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=\"Edit Sections: ${this.#sectionHeading}\">\r\n\t\t\t\t<div id=\"main\">\r\n\t\t\t\t\t<div class=\"section-info\">\r\n\t\t\t\t\t\t<span class=\"meta-badge\">${this.#elements.length} elements</span>\r\n\t\t\t\t\t\t<span class=\"meta-badge\">${this._rules.length} rules</span>\r\n\t\t\t\t\t\t<span class=\"meta-badge\">${claimed.size} matched</span>\r\n\t\t\t\t\t\t<span class=\"meta-badge\">${this.#elements.length - claimed.size} unmatched</span>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t${this._rules.map((rule, idx) => this.#renderRuleCard(rule, idx, ruleMatches.get(idx) ?? []))}\r\n\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\t\t\tlabel=\"Add rule\"\r\n\t\t\t\t\t\t@click=${this.#addRule}>\r\n\t\t\t\t\t\t+ Add another rule\r\n\t\t\t\t\t</uui-button>\r\n\r\n\t\t\t\t\t${this.#renderUnmatchedElements(claimed)}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div slot=\"actions\">\r\n\t\t\t\t\t<uui-button label=\"Close\" @click=${this.#onClose}>Close</uui-button>\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tlabel=\"Save\"\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\t@click=${this.#onSubmit}>\r\n\t\t\t\t\t\tSave\r\n\t\t\t\t\t</uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t#main {\r\n\t\t\t\tpadding: var(--uui-size-space-4);\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t.section-info {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t}\r\n\r\n\t\t\t.meta-badge {\r\n\t\t\t\tfont-size: 11px;\r\n\t\t\t\tfont-family: monospace;\r\n\t\t\t\tpadding: 1px 6px;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tbackground: var(--uui-color-surface-alt);\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t}\r\n\r\n\t\t\t/* Rule cards */\r\n\t\t\t.rule-card {\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t}\r\n\r\n\t\t\t.rule-header {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t\tbackground: var(--uui-color-surface-alt);\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.rule-number {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\twidth: 24px;\r\n\t\t\t\theight: 24px;\r\n\t\t\t\tborder-radius: 50%;\r\n\t\t\t\tbackground: var(--uui-color-default-emphasis);\r\n\t\t\t\tcolor: var(--uui-color-default-contrast);\r\n\t\t\t\tfont-size: 12px;\r\n\t\t\t\tfont-weight: 700;\r\n\t\t\t\tflex-shrink: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.role-name-input {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tpadding: var(--uui-size-space-1) var(--uui-size-space-2);\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tfont-size: var(--uui-type-default-size);\r\n\t\t\t\tfont-family: monospace;\r\n\t\t\t\tbackground: var(--uui-color-surface);\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\r\n\t\t\t.role-name-input:focus {\r\n\t\t\t\toutline: none;\r\n\t\t\t\tborder-color: var(--uui-color-focus);\r\n\t\t\t}\r\n\r\n\t\t\t/* Conditions */\r\n\t\t\t.conditions-area {\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t.condition-row {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\t.condition-type-select {\r\n\t\t\t\tmin-width: 180px;\r\n\t\t\t\tpadding: var(--uui-size-space-1) var(--uui-size-space-2);\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tbackground: var(--uui-color-surface);\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\r\n\t\t\t.condition-type-select:focus {\r\n\t\t\t\toutline: none;\r\n\t\t\t\tborder-color: var(--uui-color-focus);\r\n\t\t\t}\r\n\r\n\t\t\t.condition-value-input {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tpadding: var(--uui-size-space-1) var(--uui-size-space-2);\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tfont-family: monospace;\r\n\t\t\t\tbackground: var(--uui-color-surface);\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\r\n\t\t\t.condition-value-input:focus {\r\n\t\t\t\toutline: none;\r\n\t\t\t\tborder-color: var(--uui-color-focus);\r\n\t\t\t}\r\n\r\n\t\t\t/* Action area */\r\n\t\t\t.action-area {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t\tborder-top: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.action-label {\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tfont-weight: 600;\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t\tflex-shrink: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.action-select {\r\n\t\t\t\tpadding: var(--uui-size-space-1) var(--uui-size-space-2);\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tbackground: var(--uui-color-surface);\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\r\n\t\t\t.action-select:focus {\r\n\t\t\t\toutline: none;\r\n\t\t\t\tborder-color: var(--uui-color-focus);\r\n\t\t\t}\r\n\r\n\t\t\t/* Match preview */\r\n\t\t\t.match-preview {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tpadding: var(--uui-size-space-2) var(--uui-size-space-4);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tborder-top: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.match-preview.matched {\r\n\t\t\t\tbackground: color-mix(in srgb, var(--uui-color-positive) 10%, transparent);\r\n\t\t\t\tcolor: var(--uui-color-positive-standalone);\r\n\t\t\t}\r\n\r\n\t\t\t.match-preview.no-match {\r\n\t\t\t\tbackground: color-mix(in srgb, var(--uui-color-warning) 10%, transparent);\r\n\t\t\t\tcolor: var(--uui-color-warning-standalone);\r\n\t\t\t}\r\n\r\n\t\t\t.match-preview strong {\r\n\t\t\t\tfont-weight: 600;\r\n\t\t\t}\r\n\r\n\t\t\t/* Unmatched elements */\r\n\t\t\t.unmatched-section {\r\n\t\t\t\tborder: 1px dashed var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tpadding: var(--uui-size-space-3) var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t.unmatched-section h4 {\r\n\t\t\t\tmargin: 0 0 var(--uui-size-space-3);\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\ttext-transform: uppercase;\r\n\t\t\t\tletter-spacing: 0.5px;\r\n\t\t\t}\r\n\r\n\t\t\t.unmatched-element {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t\tpadding: var(--uui-size-space-2) 0;\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\r\n\t\t\t.unmatched-element:last-child {\r\n\t\t\t\tborder-bottom: none;\r\n\t\t\t}\r\n\r\n\t\t\t.unmatched-text {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tfont-size: var(--uui-type-small-size);\r\n\t\t\t\tmin-width: 0;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t}\r\n\r\n\t\t\t.unmatched-meta {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tgap: var(--uui-size-space-1);\r\n\t\t\t\tflex-shrink: 0;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UpDocSectionRulesEditorModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'up-doc-section-rules-editor-modal': UpDocSectionRulesEditorModalElement;\r\n\t}\r\n}\r\n"],"names":["_UpDocSectionRulesEditorModalElement_instances","elements_get","sectionHeading_get","evaluateRules_fn","elementMatchesAllConditions_fn","elementMatchesCondition_fn","autoPopulateConditions_fn","addRule_fn","removeRule_fn","createRuleFromElement_fn","updateRoleName_fn","updateAction_fn","addCondition_fn","removeCondition_fn","updateConditionType_fn","updateConditionValue_fn","onSubmit_fn","onClose_fn","renderConditionRow_fn","renderRuleCard_fn","truncate_fn","renderUnmatchedElements_fn","CONDITION_LABELS","VALUELESS_CONDITIONS","ALL_CONDITION_TYPES","ACTION_LABELS","ALL_ACTIONS","UpDocSectionRulesEditorModalElement","UmbModalBaseElement","__privateAdd","claimed","__privateMethod","ruleMatches","elId","ruleIdx","el","__privateGet","e","existing","html","rule","idx","elements","elIdx","conditions","index","total","c","condition","val","numVal","elIndex","colonIdx","_","i","roleSuggestion","value","updated","condIdx","type","cond","isNumeric","isValueless","t","nothing","matchedElements","cIdx","a","text","max","unmatched","UmbTextStyles","css","__decorateClass","state","customElement","UpDocSectionRulesEditorModalElement_default"],"mappings":";;;;;;;;;+TAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAQA,MAAMC,IAAsD;AAAA,EAC3D,gBAAgB;AAAA,EAChB,cAAc;AAAA,EACd,cAAc;AAAA,EACd,YAAY;AAAA,EACZ,oBAAoB;AAAA,EACpB,gBAAgB;AAAA,EAChB,eAAe;AAAA,EACf,eAAe;AAAA,EACf,kBAAkB;AAAA,EAClB,gBAAgB;AAAA,EAChB,aAAa;AAAA,EACb,eAAe;AAAA,EACf,cAAc;AACf,GAGMC,IAA4C,CAAC,iBAAiB,cAAc,GAG5EC,IAA2C;AAAA,EAChD;AAAA,EAAkB;AAAA,EAAgB;AAAA,EAAgB;AAAA,EAAc;AAAA,EAChE;AAAA,EAAkB;AAAA,EAAiB;AAAA,EACnC;AAAA,EAAoB;AAAA,EAAkB;AAAA,EACtC;AAAA,EAAiB;AAClB,GAGMC,IAA4C;AAAA,EACjD,eAAe;AAAA,EACf,cAAc;AAAA,EACd,cAAc;AAAA,EACd,WAAW;AAAA,EACX,SAAS;AACV,GAGMC,IAA4B,CAAC,iBAAiB,gBAAgB,gBAAgB,aAAa,SAAS;AAGnG,IAAMC,IAAN,cAAkDC,EAA+E;AAAA,EAAjI,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAC,EAAA,MAAA7B,CAAA,GACG,KAAQ,SAAwB,CAAA;AAAA,EAAC;AAAA,EAEjC,eAAe;AAEvB,IAAI,KAAK,MAAM,eAAe,OAAO,WACpC,KAAK,SAAS,KAAK,MAAM,KAAK,UAAU,KAAK,KAAK,cAAc,KAAK,CAAC;AAAA,EAExE;AAAA,EAuTS,SAAS;AACjB,UAAM8B,IAAUC,QAAK/B,GAAAG,CAAA,EAAL,KAAA,IAAA,GAGV6B,wBAAkB,IAAA;AACxB,eAAW,CAACC,GAAMC,CAAO,KAAKJ,GAAS;AACtC,YAAMK,IAAKC,QAAKpC,GAAAC,CAAA,EAAU,KAAK,CAACoC,MAAMA,EAAE,OAAOJ,CAAI;AACnD,UAAIE,GAAI;AACP,cAAMG,IAAWN,EAAY,IAAIE,CAAO,KAAK,CAAA;AAC7C,QAAAI,EAAS,KAAKH,CAAE,GAChBH,EAAY,IAAIE,GAASI,CAAQ;AAAA,MAClC;AAAA,IACD;AAEA,WAAOC;AAAA,+CACsCH,QAAKpC,GAAAE,CAAA,CAAe;AAAA;AAAA;AAAA,iCAGlCkC,EAAA,MAAKpC,MAAU,MAAM;AAAA,iCACrB,KAAK,OAAO,MAAM;AAAA,iCAClB8B,EAAQ,IAAI;AAAA,iCACZM,EAAA,MAAKpC,GAAAC,CAAA,EAAU,SAAS6B,EAAQ,IAAI;AAAA;AAAA;AAAA,OAG9D,KAAK,OAAO,IAAI,CAACU,GAAMC,MAAQV,EAAA,MAAK/B,GAAAmB,CAAA,EAAL,KAAA,MAAqBqB,GAAMC,GAAKT,EAAY,IAAIS,CAAG,KAAK,CAAA,EAAG,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,eAKnFV,QAAK/B,GAAAO,CAAA,CAAQ;AAAA;AAAA;AAAA;AAAA,OAIrBwB,EAAA,MAAK/B,GAAAqB,CAAA,EAAL,KAAA,MAA8BS,CAAA,CAAQ;AAAA;AAAA;AAAA;AAAA,wCAILC,QAAK/B,GAAAiB,CAAA,CAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,eAKtCc,QAAK/B,GAAAgB,CAAA,CAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAM5B;AA4ND;AA3kBOhB,IAAA,oBAAA,QAAA;AAUFC,IAAS,WAAkB;AAC9B,SAAO,KAAK,MAAM,YAAY,CAAA;AAC/B;AAEIC,IAAe,WAAW;AAC7B,SAAO,KAAK,MAAM,kBAAkB;AACrC;AAKAC,IAAc,WAAwB;AACrC,QAAM2B,wBAAc,IAAA,GACdY,IAAWN,EAAA,MAAKpC,GAAAC,CAAA;AAEtB,WAASiC,IAAU,GAAGA,IAAU,KAAK,OAAO,QAAQA,KAAW;AAC9D,UAAMM,IAAO,KAAK,OAAON,CAAO;AAChC,QAAIM,EAAK,WAAW,WAAW;AAE/B,eAASG,IAAQ,GAAGA,IAAQD,EAAS,QAAQC,KAAS;AACrD,cAAMR,IAAKO,EAASC,CAAK;AACzB,QAAIb,EAAQ,IAAIK,EAAG,EAAE,KAEjBJ,EAAA,MAAK/B,MAAL,KAAA,MAAkCmC,GAAIK,EAAK,YAAYG,GAAOD,EAAS,MAAA,KAC1EZ,EAAQ,IAAIK,EAAG,IAAID,CAAO;AAAA,MAG5B;AAAA,EACD;AACA,SAAOJ;AACR;AAEA1B,IAA4B,SAAC+B,GAAiBS,GAA6BC,GAAeC,GAAwB;AACjH,SAAOF,EAAW,MAAM,CAACG,MAAMhB,EAAA,MAAK/B,MAAL,KAAA,MAA8BmC,GAAIY,GAAGF,GAAOC,CAAA,CAAM;AAClF;AAEAzC,IAAwB,SAAC8B,GAAiBa,GAA0BH,GAAeC,GAAwB;AAC1G,QAAMG,IAAM,OAAOD,EAAU,SAAS,EAAE,GAClCE,IAAS,OAAOF,EAAU,KAAK;AAErC,UAAQA,EAAU,MAAA;AAAA,IACjB,KAAK;AACJ,aAAOb,EAAG,KAAK,YAAA,EAAc,WAAWc,EAAI,aAAa;AAAA,IAC1D,KAAK;AACJ,aAAOd,EAAG,KAAK,YAAA,EAAc,SAASc,EAAI,aAAa;AAAA,IACxD,KAAK;AACJ,aAAOd,EAAG,KAAK,YAAA,EAAc,SAASc,EAAI,aAAa;AAAA,IACxD,KAAK;AACJ,UAAI;AAAE,eAAO,IAAI,OAAOA,GAAK,GAAG,EAAE,KAAKd,EAAG,IAAI;AAAA,MAAG,QAAQ;AAAE,eAAO;AAAA,MAAO;AAAA,IAC1E,KAAK;AACJ,aAAO,CAAC,MAAMe,CAAM,KAAK,KAAK,IAAIf,EAAG,WAAWe,CAAM,IAAI;AAAA,IAC3D,KAAK;AACJ,aAAO,CAAC,MAAMA,CAAM,KAAKf,EAAG,WAAWe;AAAA,IACxC,KAAK;AACJ,aAAO,CAAC,MAAMA,CAAM,KAAKf,EAAG,WAAWe;AAAA,IACxC,KAAK;AACJ,aAAOf,EAAG,SAAS,YAAA,EAAc,SAASc,EAAI,aAAa;AAAA,IAC5D,KAAK;AACJ,aAAOd,EAAG,MAAM,YAAA,MAAkBc,EAAI,YAAA;AAAA,IACvC,KAAK;AACJ,aAAOJ,MAAU;AAAA,IAClB,KAAK;AACJ,aAAOA,MAAUC,IAAQ;AAAA,IAC1B;AACC,aAAO;AAAA,EAAA;AAEV;AAIAxC,IAAuB,SAAC6B,GAAiBgB,GAAiBL,GAAgC;AACzF,QAAMF,IAA8B,CAAA;AAGpC,EAAAA,EAAW,KAAK,EAAE,MAAM,kBAAkB,OAAOT,EAAG,UAAU,GAG1DA,EAAG,YACNS,EAAW,KAAK,EAAE,MAAM,oBAAoB,OAAOT,EAAG,UAAU,GAI7DA,EAAG,SAASA,EAAG,MAAM,YAAA,MAAkB,aAAaA,EAAG,MAAM,YAAA,MAAkB,UAClFS,EAAW,KAAK,EAAE,MAAM,eAAe,OAAOT,EAAG,OAAO;AAIzD,QAAMiB,IAAWjB,EAAG,KAAK,QAAQ,GAAG;AACpC,SAAIiB,IAAW,KAAKA,IAAW,MAC9BR,EAAW,KAAK,EAAE,MAAM,kBAAkB,OAAOT,EAAG,KAAK,UAAU,GAAGiB,IAAW,CAAC,EAAA,CAAG,GAIlFD,MAAY,IACfP,EAAW,KAAK,EAAE,MAAM,gBAAA,CAAiB,IAC/BO,MAAYL,IAAQ,KAC9BF,EAAW,KAAK,EAAE,MAAM,eAAA,CAAgB,GAGlCA;AACR;AAIArC,IAAQ,WAAG;AACV,OAAK,SAAS,CAAC,GAAG,KAAK,QAAQ,EAAE,MAAM,IAAI,QAAQ,iBAA+B,YAAY,CAAA,GAAI;AACnG;AAEAC,IAAW,SAAC0B,GAAiB;AAC5B,OAAK,SAAS,KAAK,OAAO,OAAO,CAACmB,GAAGC,MAAMA,MAAMpB,CAAO;AACzD;AAEAzB,IAAsB,SAAC0B,GAAiBgB,GAAiB;AACxD,QAAMP,IAAab,EAAA,MAAK/B,GAAAM,CAAA,EAAL,WAA6B6B,GAAIgB,GAASf,QAAKpC,GAAAC,CAAA,EAAU,MAAA,GAEtEsD,IAAiBpB,EAAG,KACxB,MAAM,SAAS,EACf,MAAM,GAAG,CAAC,EACV,KAAK,GAAG,EACR,cACA,QAAQ,eAAe,EAAE;AAC3B,OAAK,SAAS,CAAC,GAAG,KAAK,QAAQ,EAAE,MAAMoB,GAAgB,QAAQ,iBAA+B,YAAAX,EAAA,CAAY;AAC3G;AAEAlC,IAAe,SAACwB,GAAiBsB,GAAe;AAC/C,QAAMC,IAAU,CAAC,GAAG,KAAK,MAAM;AAC/B,EAAAA,EAAQvB,CAAO,IAAI,EAAE,GAAGuB,EAAQvB,CAAO,GAAG,MAAMsB,EAAA,GAChD,KAAK,SAASC;AACf;AAEA9C,IAAa,SAACuB,GAAiBsB,GAAmB;AACjD,QAAMC,IAAU,CAAC,GAAG,KAAK,MAAM;AAC/B,EAAAA,EAAQvB,CAAO,IAAI,EAAE,GAAGuB,EAAQvB,CAAO,GAAG,QAAQsB,EAAA,GAClD,KAAK,SAASC;AACf;AAEA7C,IAAa,SAACsB,GAAiB;AAC9B,QAAMuB,IAAU,CAAC,GAAG,KAAK,MAAM,GACzBjB,IAAO,EAAE,GAAGiB,EAAQvB,CAAO,EAAA;AACjC,EAAAM,EAAK,aAAa,CAAC,GAAGA,EAAK,YAAY,EAAE,MAAM,kBAAkB,OAAO,IAAI,GAC5EiB,EAAQvB,CAAO,IAAIM,GACnB,KAAK,SAASiB;AACf;AAEA5C,IAAgB,SAACqB,GAAiBwB,GAAiB;AAClD,QAAMD,IAAU,CAAC,GAAG,KAAK,MAAM,GACzBjB,IAAO,EAAE,GAAGiB,EAAQvB,CAAO,EAAA;AACjC,EAAAM,EAAK,aAAaA,EAAK,WAAW,OAAO,CAACa,GAAGC,MAAMA,MAAMI,CAAO,GAChED,EAAQvB,CAAO,IAAIM,GACnB,KAAK,SAASiB;AACf;AAEA3C,IAAoB,SAACoB,GAAiBwB,GAAiBC,GAAyB;AAC/E,QAAMF,IAAU,CAAC,GAAG,KAAK,MAAM,GACzBjB,IAAO,EAAE,GAAGiB,EAAQvB,CAAO,EAAA;AACjC,EAAAM,EAAK,aAAa,CAAC,GAAGA,EAAK,UAAU,GACrCA,EAAK,WAAWkB,CAAO,IAAI;AAAA,IAC1B,MAAAC;AAAA,IACA,OAAOpC,EAAqB,SAASoC,CAAI,IAAI,SAAYnB,EAAK,WAAWkB,CAAO,EAAE;AAAA,EAAA,GAEnFD,EAAQvB,CAAO,IAAIM,GACnB,KAAK,SAASiB;AACf;AAEA1C,IAAqB,SAACmB,GAAiBwB,GAAiBF,GAAe;AACtE,QAAMC,IAAU,CAAC,GAAG,KAAK,MAAM,GACzBjB,IAAO,EAAE,GAAGiB,EAAQvB,CAAO,EAAA;AACjC,EAAAM,EAAK,aAAa,CAAC,GAAGA,EAAK,UAAU;AACrC,QAAMoB,IAAOpB,EAAK,WAAWkB,CAAO,GAE9BG,IAAYD,EAAK,SAAS,oBAAoBA,EAAK,SAAS,mBAAmBA,EAAK,SAAS;AACnG,EAAApB,EAAK,WAAWkB,CAAO,IAAI,EAAE,GAAGE,GAAM,OAAOC,KAAa,CAAC,MAAM,OAAOL,CAAK,CAAC,IAAI,OAAOA,CAAK,IAAIA,EAAA,GAClGC,EAAQvB,CAAO,IAAIM,GACnB,KAAK,SAASiB;AACf;AAIAzC,IAAS,WAAG;AACX,OAAK,QAAQ,EAAE,OAAO,EAAE,OAAO,KAAK,SAAO,GAC3C,KAAK,cAAc,OAAA;AACpB;AAEAC,IAAQ,WAAG;AACV,OAAK,cAAc,OAAA;AACpB;AAIAC,IAAmB,SAACgB,GAAiBwB,GAAiBV,GAA0B;AAC/E,QAAMc,IAAcvC,EAAqB,SAASyB,EAAU,IAAI;AAChE,SAAOT;AAAA;AAAA;AAAA;AAAA,cAIKS,EAAU,IAAI;AAAA,eACb,CAACX,MAAaN,EAAA,MAAK/B,GAAAc,CAAA,EAAL,WAA0BoB,GAASwB,GAAUrB,EAAE,OAA6B,KAAA,CAA2B;AAAA,OAC7Hb,EAAoB,IAAI,CAACuC,MAAMxB;AAAA,sBAChBwB,CAAC,cAAcA,MAAMf,EAAU,IAAI,IAAI1B,EAAiByC,CAAC,CAAC;AAAA,MAC1E,CAAC;AAAA;AAAA,MAEDD,IAAcE,IAAUzB;AAAA;AAAA;AAAA;AAAA;AAAA,eAKf,OAAOS,EAAU,SAAS,EAAE,CAAC;AAAA,eAC7B,CAACX,MAAaN,EAAA,MAAK/B,GAAAe,CAAA,EAAL,WAA2BmB,GAASwB,GAAUrB,EAAE,OAA4B,KAAA,CAAM;AAAA,KAC1G;AAAA;AAAA;AAAA;AAAA;AAAA,cAKS,MAAMN,EAAA,MAAK/B,GAAAa,CAAA,EAAL,KAAA,MAAsBqB,GAASwB,CAAA,CAAQ;AAAA;AAAA;AAAA;AAAA;AAK1D;AAEAvC,IAAe,SAACqB,GAAmBN,GAAiB+B,GAAgC;AACnF,SAAO1B;AAAA;AAAA;AAAA,iCAGwBL,IAAU,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,eAK7BM,EAAK,IAAI;AAAA,eACT,CAACH,MAAaN,EAAA,MAAK/B,GAAAU,CAAA,EAAL,WAAqBwB,GAAUG,EAAE,OAA4B,KAAA,CAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAMjF,MAAMN,EAAA,MAAK/B,GAAAQ,CAAA,EAAL,KAAA,MAAiB0B,CAAA,CAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAMvCM,EAAK,WAAW,IAAI,CAACoB,GAAMM,MAASnC,EAAA,MAAK/B,GAAAkB,CAAA,EAAL,KAAA,MAAyBgB,GAASgC,GAAMN,CAAA,CAAK,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,eAK1E,MAAM7B,EAAA,MAAK/B,GAAAY,CAAA,EAAL,KAAA,MAAmBsB,CAAA,CAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eASjCM,EAAK,UAAU,eAAe;AAAA,gBAC7B,CAACH,MAAaN,EAAA,MAAK/B,GAAAW,CAAA,EAAL,WAAmBuB,GAAUG,EAAE,OAA6B,KAAA,CAAoB;AAAA,QACtGX,EAAY,IAAI,CAACyC,MAAM5B;AAAA,uBACR4B,CAAC,cAAcA,OAAO3B,EAAK,UAAU,gBAAgB,IAAIf,EAAc0C,CAAC,CAAC;AAAA,OACzF,CAAC;AAAA;AAAA;AAAA;AAAA,gCAIwBF,EAAgB,SAAS,IAAI,YAAY,UAAU;AAAA,OAC5EA,EAAgB,SAAS,IACxB1B,4DAA+D0B,EAAgB,MAAM,mBAAmBA,EAAgB,UAAU,IAAI1B,MAAS0B,EAAgB,IAAI,CAAC9B,GAAImB,MAAMf,IAAOe,IAAI,IAAIf,QAAWyB,CAAO,WAAWjC,QAAK/B,GAAAoB,CAAA,EAAL,KAAA,MAAee,EAAG,MAAM,EAAA,CAAG,WAAW,CAAC,KAAK6B,CAAO,KAC7QzB,4CAA+CC,EAAK,WAAW,WAAW,IAAI,qCAAqC,UAAU,EAAE;AAAA;AAAA;AAAA;AAItI;AAEApB,IAAS,SAACgD,GAAcC,GAAqB;AAC5C,SAAOD,EAAK,SAASC,IAAMD,EAAK,UAAU,GAAGC,CAAG,IAAI,QAAQD;AAC7D;AAEA/C,IAAwB,SAACS,GAA8B;AACtD,QAAMY,IAAWN,EAAA,MAAKpC,GAAAC,CAAA,GAChBqE,IAAY5B,EAAS,OAAO,CAACP,MAAO,CAACL,EAAQ,IAAIK,EAAG,EAAE,CAAC;AAC7D,SAAImC,EAAU,WAAW,IAAUN,IAE5BzB;AAAA;AAAA,8BAEqB+B,EAAU,MAAM;AAAA,MACxCA,EAAU,IAAI,CAACnC,MAAO;AACvB,UAAMgB,IAAUT,EAAS,QAAQP,CAAE;AACnC,WAAOI;AAAA;AAAA,qCAEyBR,EAAA,MAAK/B,GAAAoB,CAAA,EAAL,KAAA,MAAee,EAAG,MAAM,EAAA,CAAG;AAAA;AAAA,mCAE7BA,EAAG,QAAQ;AAAA,mCACXA,EAAG,QAAQ;AAAA,UACpCA,EAAG,UAAU,YAAYI,2DAA8DJ,EAAG,KAAK,MAAMA,EAAG,KAAK,YAAY6B,CAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAMzH,MAAMjC,EAAA,MAAK/B,GAAAS,CAAA,EAAL,KAAA,MAA4B0B,GAAIgB,CAAA,CAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,EAK3D,CAAC,CAAC;AAAA;AAAA;AAGL;AA7TYxB,EAiXI,SAAS;AAAA,EACxB4C;AAAA,EACAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAuND;AAzkBiBC,EAAA;AAAA,EAAhBC,EAAA;AAAM,GADK/C,EACK,WAAA,UAAA,CAAA;AADLA,IAAN8C,EAAA;AAAA,EADNE,EAAc,mCAAmC;AAAA,GACrChD,CAAA;AA6kBb,MAAAiD,IAAejD;"}